<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Case study 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Online EDA_files/libs/clipboard/clipboard.min.js"></script>
<script src="Online EDA_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Online EDA_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Online EDA_files/libs/quarto-html/popper.min.js"></script>
<script src="Online EDA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Online EDA_files/libs/quarto-html/anchor.min.js"></script>
<link href="Online EDA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Online EDA_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Online EDA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Online EDA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Online EDA_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="Online EDA_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="Online EDA_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="Online EDA_files/libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="Online EDA_files/libs/typedarray-0.1/typedarray.min.js"></script>

<script src="Online EDA_files/libs/jquery-3.5.1/jquery.min.js"></script>

<link href="Online EDA_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="Online EDA_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="Online EDA_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="Online EDA_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>



</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Case study 2</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'caret' was built under R version 4.5.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ stringr   1.5.1
✔ forcats   1.0.0     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
✖ purrr::lift()   masks caret::lift()
✖ dplyr::select() masks MASS::select()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'corrplot' was built under R version 4.5.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData

Attaching package: 'car'

The following object is masked from 'package:dplyr':

    recode

The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sqldf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'sqldf' was built under R version 4.5.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gsubfn</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gsubfn' was built under R version 4.5.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: proto</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'proto' was built under R version 4.5.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: RSQLite</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'RSQLite' was built under R version 4.5.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'

The following object is masked from 'package:purrr':

    discard

The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gridExtra' was built under R version 4.5.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'

The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
</div>
<section id="eda" class="level1">
<h1>EDA</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"online_retail.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Invoice           StockCode         Description           Quantity       
 Length:525461      Length:525461      Length:525461      Min.   :-9600.00  
 Class :character   Class :character   Class :character   1st Qu.:    1.00  
 Mode  :character   Mode  :character   Mode  :character   Median :    3.00  
                                                          Mean   :   10.34  
                                                          3rd Qu.:   10.00  
                                                          Max.   :19152.00  
                                                                            
  InvoiceDate                      Price             Customer ID    
 Min.   :2009-12-01 07:45:00   Min.   :-53594.360   Min.   :12346   
 1st Qu.:2010-03-21 12:20:00   1st Qu.:     1.250   1st Qu.:13983   
 Median :2010-07-06 09:51:00   Median :     2.100   Median :15311   
 Mean   :2010-06-28 11:37:36   Mean   :     4.689   Mean   :15361   
 3rd Qu.:2010-10-15 12:45:00   3rd Qu.:     4.210   3rd Qu.:16799   
 Max.   :2010-12-09 20:01:00   Max.   : 25111.090   Max.   :18287   
                                                    NA's   :107927  
   Country         
 Length:525461     
 Class :character  
 Mode  :character  
                   
                   
                   
                   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [525,461 × 8] (S3: tbl_df/tbl/data.frame)
 $ Invoice    : chr [1:525461] "489434" "489434" "489434" "489434" ...
 $ StockCode  : chr [1:525461] "85048" "79323P" "79323W" "22041" ...
 $ Description: chr [1:525461] "15CM CHRISTMAS GLASS BALL 20 LIGHTS" "PINK CHERRY LIGHTS" "WHITE CHERRY LIGHTS" "RECORD FRAME 7\" SINGLE SIZE" ...
 $ Quantity   : num [1:525461] 12 12 12 48 24 24 24 10 12 12 ...
 $ InvoiceDate: POSIXct[1:525461], format: "2009-12-01 07:45:00" "2009-12-01 07:45:00" ...
 $ Price      : num [1:525461] 6.95 6.75 6.75 2.1 1.25 1.65 1.25 5.95 2.55 3.75 ...
 $ Customer ID: num [1:525461] 13085 13085 13085 13085 13085 ...
 $ Country    : chr [1:525461] "United Kingdom" "United Kingdom" "United Kingdom" "United Kingdom" ...</code></pre>
</div>
</div>
<p>Categorical Variables: Invoice StockCode Description Country InvoiceDate</p>
<p>Numerical Variables: Quantity Price Customer ID</p>
<p>Thoughts: Maybe certain times are better to increase prices? Customers are less price sensitive during holidays etc. Also important to make sure not to run out of products.</p>
<p>if you buy christmas lights do you also buy something else - market basket increase certain products during certain times</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check for NA's</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Description NA's... those products still matter but what are they</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Invoice   StockCode Description    Quantity InvoiceDate       Price 
          0           0        2928           0           0           0 
Customer ID     Country 
     107927           0 </code></pre>
</div>
</div>
<p>Customer ID is missing a ton of values, does that mean those aren’t sales? the quantity still changes so there were sales that existed but for some reason there aren’t Customer ID’s, not sure what that indicates</p>
</section>
<section id="data-cleaning" class="level1">
<h1>Data Cleaning</h1>
<section id="important-stock-code-m-will-need-to-be-removed-when-modeling-stock" class="level2">
<h2 class="anchored" data-anchor-id="important-stock-code-m-will-need-to-be-removed-when-modeling-stock">Important: Stock code M will need to be removed when modeling stock</h2>
<p>M is manual override. For some reason, the product information was lost but the sales, quantity, and customer info was retained for that sale. Keeping M in for the meantime to accurately track sales and customer spending.</p>
<p>df &lt;- df |&gt; filter(!StockCode %in% c(“M”))</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># trim spaces in character columns</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), trimws))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove completely empty strings</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span><span class="fu">na_if</span>(., <span class="st">""</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a new column Revenue as the product of price and quantity</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Revenue =</span> Price <span class="sc">*</span> Quantity)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert InvoiceDate to Date format</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>InvoiceDate <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(df<span class="sc">$</span>InvoiceDate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Invoice StockCode Description Quantity InvoiceDate Price `Customer ID` Country
  &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;  
1 489434  85048     "15CM CHRI…       12 2009-12-01   6.95         13085 United…
2 489434  79323P    "PINK CHER…       12 2009-12-01   6.75         13085 United…
3 489434  79323W    "WHITE CHE…       12 2009-12-01   6.75         13085 United…
4 489434  22041     "RECORD FR…       48 2009-12-01   2.1          13085 United…
5 489434  21232     "STRAWBERR…       24 2009-12-01   1.25         13085 United…
6 489434  22064     "PINK DOUG…       24 2009-12-01   1.65         13085 United…
# ℹ 1 more variable: Revenue &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NAs in Description with the most common description for each StockCode</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(StockCode) <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Description), </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">first</span>(Description[<span class="sc">!</span><span class="fu">is.na</span>(Description)]), </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                        Description)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># check null results now</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Description)) <span class="sc">|&gt;</span> </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 365</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Invoice   StockCode Description    Quantity InvoiceDate       Price 
          0           0         365           0           0           0 
Customer ID     Country     Revenue 
     107927           0           0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See which StockCodes still have null descriptions</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>null_by_stockcode <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(Description)) <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(StockCode) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>(),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_Invoice =</span> <span class="fu">first</span>(Invoice),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Count))</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(null_by_stockcode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 356 × 3
   StockCode    Count Sample_Invoice
   &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;         
 1 21502            2 494114        
 2 22016            2 496253        
 3 35983            2 490736        
 4 84494B           2 495330        
 5 84558B           2 493226        
 6 84933D           2 495191        
 7 90025A           2 498056        
 8 gift_0001_60     2 496250        
 9 gift_0001_90     2 496252        
10 10124C           1 507811        
# ℹ 346 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove POST and DOT, postage isn't a product they actually sell, they just charge for it</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>StockCode <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"POST"</span>, <span class="st">"DOT"</span>))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify they're gone</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(StockCode <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"POST"</span>, <span class="st">"DOT"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># negative quantities I don't want to necessarily completely delete since they may be useful</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate returns/adjustments from regular sales</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df will be the sales df </span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>returns_df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Quantity <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Quantity <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View all rows with negative quantities</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># See how many there are</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(returns_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12221</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View them</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(returns_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Invoice StockCode Description Quantity InvoiceDate Price `Customer ID` Country
  &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;  
1 C489449 22087     PAPER BUNT…      -12 2009-12-01   2.95         16321 Austra…
2 C489449 85206A    CREAM FELT…       -6 2009-12-01   1.65         16321 Austra…
3 C489449 21895     POTTING SH…       -4 2009-12-01   4.25         16321 Austra…
4 C489449 21896     POTTING SH…       -6 2009-12-01   2.1          16321 Austra…
5 C489449 22083     PAPER CHAI…      -12 2009-12-01   2.95         16321 Austra…
6 C489449 21871     SAVE THE P…      -12 2009-12-01   1.25         16321 Austra…
# ℹ 1 more variable: Revenue &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># looks like for some of them it's the same customer doing the negative quantity</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>returns_df <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, Invoice, StockCode, Description, Quantity, Price, Country, InvoiceDate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12,221 × 8
   `Customer ID` Invoice StockCode Description            Quantity Price Country
           &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;                     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  
 1         16321 C489449 22087     PAPER BUNTING WHITE L…      -12  2.95 Austra…
 2         16321 C489449 85206A    CREAM FELT EASTER EGG…       -6  1.65 Austra…
 3         16321 C489449 21895     POTTING SHED SOW 'N' …       -4  4.25 Austra…
 4         16321 C489449 21896     POTTING SHED TWINE           -6  2.1  Austra…
 5         16321 C489449 22083     PAPER CHAIN KIT RETRO…      -12  2.95 Austra…
 6         16321 C489449 21871     SAVE THE PLANET MUG         -12  1.25 Austra…
 7         16321 C489449 84946     ANTIQUE SILVER TEA GL…      -12  1.25 Austra…
 8         16321 C489449 84970S    HANGING HEART ZINC T-…      -24  0.85 Austra…
 9         16321 C489449 22090     PAPER BUNTING RETRO S…      -12  2.95 Austra…
10         17592 C489459 90200A    PURPLE SWEETHEART BRA…       -3  4.25 United…
# ℹ 12,211 more rows
# ℹ 1 more variable: InvoiceDate &lt;date&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rows with 0 price, don't want to completely get rid of them in case we need them later</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the 0 price rows also have some with no description, but they do have quantities</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Save zero-price rows to separate dataset</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>zero_price_df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Price <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove zero-price rows from df</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Price <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Zero price dataset:"</span>, <span class="fu">nrow</span>(zero_price_df), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zero price dataset: 1559 rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Main dataset:"</span>, <span class="fu">nrow</span>(df), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Main dataset: 510077 rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total:"</span>, <span class="fu">nrow</span>(zero_price_df) <span class="sc">+</span> <span class="fu">nrow</span>(df), <span class="st">"rows</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total: 511636 rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View all rows with negative prices</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Description says adjust bad debt, maybe some kind of charge back</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># They have a stock code of just B</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># See how many there are</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(zero_price_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1559</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View them</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(zero_price_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  Invoice StockCode Description Quantity InvoiceDate Price `Customer ID` Country
  &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt; &lt;date&gt;      &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;  
1 489659  21350     GINGHAM HE…      230 2009-12-01      0            NA United…
2 489781  84292     ROSE PINK …       17 2009-12-02      0            NA United…
3 489825  22076     6 RIBBONS …       12 2009-12-02      0         16126 United…
4 489882  35751C    PURPLE CUR…       12 2009-12-02      0            NA United…
5 489898  79323G    GOLD  CHER…      954 2009-12-03      0            NA United…
6 489903  21166     COOK WITH …       48 2009-12-03      0            NA United…
# ℹ 1 more variable: Revenue &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove B stock code</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>StockCode <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"B"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="more-eda" class="level1">
<h1>More EDA</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See the earliest and latest dates</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Spans about a year</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(df<span class="sc">$</span>InvoiceDate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2009-12-01" "2010-12-09"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique Products</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>unique_products <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(df<span class="sc">$</span>StockCode)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unique Products:"</span>, unique_products, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique Products: 4248 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique Customers</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>unique_customers <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unique Customers:"</span>, unique_customers, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique Customers: 4310 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique Countries</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>unique_countries <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(df<span class="sc">$</span>Country)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unique Countries:"</span>, unique_countries, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique Countries: 40 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique Transactions</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>unique_transactions <span class="ot">&lt;-</span> <span class="fu">n_distinct</span>(df<span class="sc">$</span>Invoice)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unique Transactions:"</span>, unique_transactions, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique Transactions: 20878 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly, weekly transactions</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly transaction counts</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>monthly_transactions <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YearMonth =</span> <span class="fu">floor_date</span>(InvoiceDate, <span class="st">"month"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YearMonth) <span class="sc">|&gt;</span> </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions =</span> <span class="fu">n_distinct</span>(Invoice),</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Customers =</span> <span class="fu">n_distinct</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Revenue =</span> <span class="fu">sum</span>(Quantity <span class="sc">*</span> Price, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(monthly_transactions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 4
   YearMonth  Transactions Customers  Revenue
   &lt;date&gt;            &lt;int&gt;     &lt;int&gt;    &lt;dbl&gt;
 1 2009-12-01         1678       953  804186.
 2 2010-01-01         1100       720  638678.
 3 2010-02-01         1198       772  544550.
 4 2010-03-01         1676      1055  819688.
 5 2010-04-01         1460       942  673025.
 6 2010-05-01         1497       965  651246.
 7 2010-06-01         1639      1040  743775.
 8 2010-07-01         1525       928  641222.
 9 2010-08-01         1420       911  687835.
10 2010-09-01         1830      1143  913492.
11 2010-10-01         2289      1496 1151734.
12 2010-11-01         2732      1607 1446815.
13 2010-12-01          834       573  424134.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average per month</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Average Transactions per Month:"</span>, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(monthly_transactions<span class="sc">$</span>Transactions), <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Average Transactions per Month: 1606 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weekly transaction counts</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>weekly_transactions <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Week =</span> <span class="fu">floor_date</span>(InvoiceDate, <span class="st">"week"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Week) <span class="sc">|&gt;</span> </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions =</span> <span class="fu">n_distinct</span>(Invoice),</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Customers =</span> <span class="fu">n_distinct</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Revenue =</span> <span class="fu">sum</span>(Quantity <span class="sc">*</span> Price, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(weekly_transactions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Week       Transactions Customers Revenue
  &lt;date&gt;            &lt;int&gt;     &lt;int&gt;   &lt;dbl&gt;
1 2009-11-29          474       367 237137.
2 2009-12-06          533       407 239057.
3 2009-12-13          529       391 264661.
4 2009-12-20          142        84  63331.
5 2010-01-03          170       140 144336.
6 2010-01-10          261       193 164208.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average per week</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Average Transactions per Week:"</span>, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(weekly_transactions<span class="sc">$</span>Transactions), <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Transactions per Week: 393.9 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly weekly Revenue</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly revenue</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>monthly_revenue <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YearMonth =</span> <span class="fu">floor_date</span>(InvoiceDate, <span class="st">"month"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YearMonth) <span class="sc">|&gt;</span> </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions =</span> <span class="fu">n_distinct</span>(Invoice),</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Customers =</span> <span class="fu">n_distinct</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Revenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Revenue_Per_Transaction =</span> <span class="fu">round</span>(<span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n_distinct</span>(Invoice), <span class="dv">2</span>),</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(monthly_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 5
   YearMonth  Transactions Customers Total_Revenue Avg_Revenue_Per_Transaction
   &lt;date&gt;            &lt;int&gt;     &lt;int&gt;         &lt;dbl&gt;                       &lt;dbl&gt;
 1 2009-12-01         1678       953       804186.                        479.
 2 2010-01-01         1100       720       638678.                        581.
 3 2010-02-01         1198       772       544550.                        455.
 4 2010-03-01         1676      1055       819688.                        489.
 5 2010-04-01         1460       942       673025.                        461.
 6 2010-05-01         1497       965       651246.                        435.
 7 2010-06-01         1639      1040       743775.                        454.
 8 2010-07-01         1525       928       641222.                        420.
 9 2010-08-01         1420       911       687835.                        484.
10 2010-09-01         1830      1143       913492.                        499.
11 2010-10-01         2289      1496      1151734.                        503.
12 2010-11-01         2732      1607      1446815.                        530.
13 2010-12-01          834       573       424134.                        509.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average per month</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Average Revenue per Month: £"</span>, </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">mean</span>(monthly_revenue<span class="sc">$</span>Total_Revenue), <span class="dv">0</span>), <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Average Revenue per Month: £ 780,029 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weekly revenue</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>weekly_revenue <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Week =</span> <span class="fu">floor_date</span>(InvoiceDate, <span class="st">"week"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Week) <span class="sc">|&gt;</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Transactions =</span> <span class="fu">n_distinct</span>(Invoice),</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Customers =</span> <span class="fu">n_distinct</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Revenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Revenue_Per_Transaction =</span> <span class="fu">round</span>(<span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n_distinct</span>(Invoice), <span class="dv">2</span>),</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(weekly_revenue, <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 5
   Week       Transactions Customers Total_Revenue Avg_Revenue_Per_Transaction
   &lt;date&gt;            &lt;int&gt;     &lt;int&gt;         &lt;dbl&gt;                       &lt;dbl&gt;
 1 2009-11-29          474       367       237137.                        500.
 2 2009-12-06          533       407       239057.                        449.
 3 2009-12-13          529       391       264661.                        500.
 4 2009-12-20          142        84        63331.                        446.
 5 2010-01-03          170       140       144336.                        849.
 6 2010-01-10          261       193       164208.                        629.
 7 2010-01-17          256       207       150823.                        589.
 8 2010-01-24          360       278       160957.                        447.
 9 2010-01-31          315       241       124037.                        394.
10 2010-02-07          263       215        87219.                        332.
11 2010-02-14          322       238       179458.                        557.
12 2010-02-21          298       225       155363.                        521.
13 2010-02-28          383       301       160167.                        418.
14 2010-03-07          334       265       149401.                        447.
15 2010-03-14          322       246       176171.                        547.
16 2010-03-21          401       313       202209.                        504.
17 2010-03-28          368       267       178755.                        486.
18 2010-04-04          253       190       117821.                        466.
19 2010-04-11          300       239       148565.                        495.
20 2010-04-18          397       281       184899.                        466.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average per week</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Average Revenue per Week: £"</span>, </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">mean</span>(weekly_revenue<span class="sc">$</span>Total_Revenue), <span class="dv">0</span>), <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Average Revenue per Week: £ 191,328 </code></pre>
</div>
</div>
</section>
<section id="which-countries-contribute-the-most-to-sales-growth" class="level1">
<h1>Which countries contribute the most to Sales growth?</h1>
<p>UK, Ireland, Netherlands, Germany, France</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># revenue by country</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Most of the distribution is in the UK and the rest of Europe</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">|&gt;</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalRevenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TotalRevenue))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 2
   Country        TotalRevenue
   &lt;chr&gt;                 &lt;dbl&gt;
 1 United Kingdom     8728553.
 2 EIRE                380978.
 3 Netherlands         266260 
 4 Germany             184165.
 5 France              137653.
 6 Sweden               51263.
 7 Denmark              50349.
 8 Spain                44526.
 9 Switzerland          41182.
10 Australia            31447.
# ℹ 30 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">|&gt;</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalRevenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TotalRevenue)) <span class="sc">|&gt;</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span>  <span class="co"># top 5</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Country, TotalRevenue), <span class="at">y =</span> TotalRevenue)) <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 5 Countries by Total Revenue"</span>,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Revenue"</span>) <span class="sc">+</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-are-the-top-selling-products" class="level1">
<h1>What are the top-selling products?</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># top selling products</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># M is manual, you can't track what M is</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 22423, 85123A, M</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(StockCode) <span class="sc">|&gt;</span> </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalRevenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TotalRevenue))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,248 × 2
   StockCode TotalRevenue
   &lt;chr&gt;            &lt;dbl&gt;
 1 M              262980.
 2 22423          170079.
 3 85123A         158591.
 4 85099B          89115.
 5 84879           73093.
 6 22086           58189.
 7 47566           49683.
 8 84347           47985.
 9 21843           45255.
10 48138           42148.
# ℹ 4,238 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Description)) <span class="sc">|&gt;</span>  <span class="co"># Remove rows with NA descriptions</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(StockCode) <span class="sc">|&gt;</span> </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">TotalRevenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Description =</span> <span class="fu">first</span>(Description)  <span class="co"># Get first description for each StockCode</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TotalRevenue)) <span class="sc">|&gt;</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Description, TotalRevenue), <span class="at">y =</span> TotalRevenue)) <span class="sc">+</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 5 Products by Total Revenue"</span>,</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Product Description"</span>,</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Revenue"</span>) <span class="sc">+</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># revenue grouped by customer</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># most of the revenue doesn't have a customer ID, who is buying all of this then</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Highest buying customers, 18102, 14646</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TotalRevenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(TotalRevenue))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,311 × 2
   `Customer ID` TotalRevenue
           &lt;dbl&gt;        &lt;dbl&gt;
 1            NA     1357117.
 2         18102      349164.
 3         14646      247614.
 4         14156      196567.
 5         14911      152148.
 6         13694      131443.
 7         17511       84541.
 8         15061       83284.
 9         16684       80489.
10         16754       65500.
# ℹ 4,301 more rows</code></pre>
</div>
</div>
</section>
<section id="time-series" class="level1">
<h1>Time Series</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create daily sales summary</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>daily_sales <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(InvoiceDate) <span class="sc">|&gt;</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Num_Transactions =</span> <span class="fu">n_distinct</span>(Invoice),</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Num_Items_Sold =</span> <span class="fu">sum</span>(Quantity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Revenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Num_Customers =</span> <span class="fu">n_distinct</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(InvoiceDate)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(daily_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  InvoiceDate Num_Transactions Num_Items_Sold Total_Revenue Num_Customers
  &lt;date&gt;                 &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;         &lt;int&gt;
1 2009-12-01               117          26177        52605.            89
2 2009-12-02               115          31891        62053.            94
3 2009-12-03               124          49242        73175.           106
4 2009-12-04                88          21309        39501.            76
5 2009-12-05                30           5119         9803.            26
6 2009-12-06                74          11615        24476.            63</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(daily_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  InvoiceDate         Num_Transactions Num_Items_Sold   Total_Revenue   
 Min.   :2009-12-01   Min.   : 14.00   Min.   :  3776   Min.   :  7856  
 1st Qu.:2010-03-09   1st Qu.: 49.50   1st Qu.: 11756   1st Qu.: 21653  
 Median :2010-06-13   Median : 63.00   Median : 16203   Median : 29241  
 Mean   :2010-06-10   Mean   : 68.01   Mean   : 18987   Mean   : 33031  
 3rd Qu.:2010-09-11   3rd Qu.: 83.00   3rd Qu.: 22459   3rd Qu.: 40174  
 Max.   :2010-12-09   Max.   :151.00   Max.   :125521   Max.   :118460  
 Num_Customers   
 Min.   : 12.00  
 1st Qu.: 41.00  
 Median : 51.00  
 Mean   : 55.28  
 3rd Qu.: 66.00  
 Max.   :132.00  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create monthly sales summary</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>monthly_sales <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">year</span>(InvoiceDate),</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">month</span>(InvoiceDate),</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">YearMonth =</span> <span class="fu">floor_date</span>(InvoiceDate, <span class="st">"month"</span>)  <span class="co"># First day of each month</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(YearMonth) <span class="sc">|&gt;</span> </span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Num_Transactions =</span> <span class="fu">n_distinct</span>(Invoice),</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Num_Items_Sold =</span> <span class="fu">sum</span>(Quantity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Revenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Num_Customers =</span> <span class="fu">n_distinct</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(YearMonth)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="co"># View monthly data</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(monthly_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 5
   YearMonth  Num_Transactions Num_Items_Sold Total_Revenue Num_Customers
   &lt;date&gt;                &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;         &lt;int&gt;
 1 2009-12-01             1678         426807       804186.           953
 2 2010-01-01             1100         391345       638678.           720
 3 2010-02-01             1198         382596       544550.           772
 4 2010-03-01             1676         527106       819688.          1055
 5 2010-04-01             1460         367968       673025.           942
 6 2010-05-01             1497         397008       651246.           965
 7 2010-06-01             1639         408402       743775.          1040
 8 2010-07-01             1525         338710       641222.           928
 9 2010-08-01             1420         473251       687835.           911
10 2010-09-01             1830         585083       913492.          1143
11 2010-10-01             2289         621749      1151734.          1496
12 2010-11-01             2732         728024      1446815.          1607
13 2010-12-01              834         180840       424134.           573</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot monthly sales</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_sales, <span class="fu">aes</span>(<span class="at">x =</span> YearMonth, <span class="at">y =</span> Num_Transactions)) <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Sales Transactions"</span>,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Transactions"</span>) <span class="sc">+</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>) <span class="sc">+</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot monthly revenue</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_sales, <span class="fu">aes</span>(<span class="at">x =</span> YearMonth, <span class="at">y =</span> Total_Revenue)) <span class="sc">+</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Revenue"</span>,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Revenue (£)"</span>) <span class="sc">+</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>) <span class="sc">+</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize for dual axis</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>monthly_sales <span class="ot">&lt;-</span> monthly_sales <span class="sc">|&gt;</span> </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Revenue_Scaled =</span> Total_Revenue <span class="sc">/</span> <span class="fu">max</span>(Total_Revenue) <span class="sc">*</span> <span class="fu">max</span>(Num_Transactions)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_sales, <span class="fu">aes</span>(<span class="at">x =</span> YearMonth)) <span class="sc">+</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Revenue bars</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y =</span> Revenue_Scaled), <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transaction line</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Num_Transactions), <span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Num_Transactions), <span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sales Transactions and Revenue Over Time"</span>,</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue line: Transactions | Green bars: Revenue"</span>,</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Transactions"</span>) <span class="sc">+</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%b %Y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 month"</span>) <span class="sc">+</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="product-sales" class="level1">
<h1>Product Sales</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify top-selling products by quantity</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>top_products <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(StockCode, Description) <span class="sc">|&gt;</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Quantity_Sold =</span> <span class="fu">sum</span>(Quantity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Revenue =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Num_Orders =</span> <span class="fu">n_distinct</span>(Invoice),</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Description), Total_Quantity_Sold <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Quantity_Sold)) <span class="sc">|&gt;</span> </span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   StockCode Description            Total_Quantity_Sold Total_Revenue Num_Orders
   &lt;chr&gt;     &lt;chr&gt;                                &lt;dbl&gt;         &lt;dbl&gt;      &lt;int&gt;
 1 85123A    WHITE HANGING HEART T…               58487       158591.       3281
 2 84077     WORLD WAR 2 GLIDERS A…               55091        11418.        501
 3 17003     BROCADE RING PURSE                   48374         8923.        230
 4 21212     PACK OF 72 RETRO SPOT…               46755        24069.       1410
 5 84879     ASSORTED COLOUR BIRD …               45348        73093.       1412
 6 84991     60 TEATIME FAIRY CAKE…               36502        18220.       1336
 7 21977     PACK OF 60 PINK PAISL…               31940        16246.       1155
 8 85099B    JUMBO BAG RED RETROSP…               30386        54484.       1222
 9 22197     SMALL POPCORN HOLDER                 29788        27035.        882
10 21232     STRAWBERRY CERAMIC TR…               27127        34497.       1640</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select top 3-5 products for forecasting</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>key_stockcodes <span class="ot">&lt;-</span> top_products<span class="sc">$</span>StockCode[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monthly demand for top products</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>monthly_demand <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(StockCode <span class="sc">%in%</span> top_products<span class="sc">$</span>StockCode) <span class="sc">|&gt;</span> </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">floor_date</span>(InvoiceDate, <span class="st">"month"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(StockCode, Description, Month) <span class="sc">|&gt;</span> </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Quantity_Sold =</span> <span class="fu">sum</span>(Quantity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(monthly_demand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 145 × 4
   StockCode Description        Month      Quantity_Sold
   &lt;chr&gt;     &lt;chr&gt;              &lt;date&gt;             &lt;dbl&gt;
 1 17003     BROCADE RING PURSE 2009-12-01           801
 2 17003     BROCADE RING PURSE 2010-01-01           961
 3 17003     BROCADE RING PURSE 2010-02-01          1895
 4 17003     BROCADE RING PURSE 2010-03-01           997
 5 17003     BROCADE RING PURSE 2010-04-01           901
 6 17003     BROCADE RING PURSE 2010-05-01          3970
 7 17003     BROCADE RING PURSE 2010-06-01          3350
 8 17003     BROCADE RING PURSE 2010-07-01          1191
 9 17003     BROCADE RING PURSE 2010-08-01          1944
10 17003     BROCADE RING PURSE 2010-09-01         13931
# ℹ 135 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the clear Christmas spike</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_demand, <span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="at">y =</span> Quantity_Sold, <span class="at">color =</span> Description)) <span class="sc">+</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monthly Demand for Top 5 Products"</span>,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Clear seasonal spike before Christmas"</span>,</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Quantity Sold"</span>) <span class="sc">+</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple forecast based on historical averages</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average demand by month across all years</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>seasonal_forecast <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(StockCode <span class="sc">%in%</span> top_products<span class="sc">$</span>StockCode) <span class="sc">|&gt;</span> </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month_Number =</span> <span class="fu">month</span>(InvoiceDate, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(StockCode, Description, Month_Number) <span class="sc">|&gt;</span> </span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Monthly_Demand =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Quantity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">0</span>),</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_Monthly_Demand =</span> <span class="fu">max</span>(Quantity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(StockCode, Month_Number)</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="co"># View forecast</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(seasonal_forecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 138 × 5
   StockCode Description      Month_Number Avg_Monthly_Demand Max_Monthly_Demand
   &lt;chr&gt;     &lt;chr&gt;            &lt;ord&gt;                     &lt;dbl&gt;              &lt;dbl&gt;
 1 17003     BROCADE RING PU… Jan                          96                720
 2 17003     BROCADE RING PU… Feb                         146                720
 3 17003     BROCADE RING PU… Mar                         100                720
 4 17003     BROCADE RING PU… Apr                         100                720
 5 17003     BROCADE RING PU… May                         284               1440
 6 17003     BROCADE RING PU… Jun                         112                720
 7 17003     BROCADE RING PU… Jul                          92                720
 8 17003     BROCADE RING PU… Aug                         177                720
 9 17003     BROCADE RING PU… Sep                         580               7128
10 17003     BROCADE RING PU… Oct                         251               4752
# ℹ 128 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize monthly pattern</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seasonal_forecast, <span class="fu">aes</span>(<span class="at">x =</span> Month_Number, <span class="at">y =</span> Avg_Monthly_Demand, </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">group =</span> Description, <span class="at">color =</span> Description)) <span class="sc">+</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Monthly Demand Pattern (Forecast Guide)"</span>,</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Use this pattern to predict future months"</span>,</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Quantity per Order"</span>) <span class="sc">+</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peak months and recommended stock levels</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>stock_recommendations <span class="ot">&lt;-</span> seasonal_forecast <span class="sc">|&gt;</span> </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(StockCode, Description) <span class="sc">|&gt;</span> </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Peak_Month =</span> Month_Number[<span class="fu">which.max</span>(Avg_Monthly_Demand)],</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Peak_Demand =</span> <span class="fu">max</span>(Avg_Monthly_Demand),</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Off_Peak_Demand =</span> <span class="fu">min</span>(Avg_Monthly_Demand),</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Recommended_Peak_Stock =</span> <span class="fu">round</span>(<span class="fu">max</span>(Avg_Monthly_Demand) <span class="sc">*</span> <span class="fl">1.5</span>, <span class="dv">0</span>),  <span class="co"># 50% buffer</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stock_recommendations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   StockCode Description                  Peak_Month Peak_Demand Off_Peak_Demand
   &lt;chr&gt;     &lt;chr&gt;                        &lt;ord&gt;            &lt;dbl&gt;           &lt;dbl&gt;
 1 17003     BROCADE RING PURSE           Sep                580              54
 2 21212     PACK OF 72 RETRO SPOT CAKE … Nov                 40              26
 3 21212     PACK OF 72 RETROSPOT CAKE C… Oct                 34              19
 4 21232     STRAWBERRY CERAMIC TRINKET … Jan                 21              12
 5 21977     PACK OF 60 PINK PAISLEY CAK… Aug                 35              17
 6 22197     POPCORN HOLDER , SMALL       Apr                108              12
 7 22197     SMALL POPCORN HOLDER         Feb                118              14
 8 84077     WORLD WAR 2 GLIDERS ASSTD D… Aug                147              63
 9 84879     ASSORTED COLOUR BIRD ORNAME… Oct                 38              20
10 84991     60 TEATIME FAIRY CAKE CASES  Feb                 40              18
11 85099B    JUMBO BAG RED RETROSPOT      Sep                 35              19
12 85099B    JUMBO BAG RED WHITE SPOTTY   Apr                 43              10
13 85099B    RED RETROSPOT JUMBO BAG      May                 29               2
14 85123A    WHITE HANGING HEART T-LIGHT… Jan                 20              14
# ℹ 1 more variable: Recommended_Peak_Stock &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="rfm-customer-segmentation" class="level1">
<h1>RFM Customer Segmentation</h1>
<section id="important-rows-with-customer-id-need-to-be-removed-since-we-cant-identify-those" class="level2">
<h2 class="anchored" data-anchor-id="important-rows-with-customer-id-need-to-be-removed-since-we-cant-identify-those">Important: rows with Customer ID need to be removed since we can’t identify those</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save null customer ID rows to separate dataset</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>null_customer_df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>))</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove from main dataset</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>))</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Null customer rows:"</span>, <span class="fu">nrow</span>(null_customer_df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Null customer rows: 103151 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Main dataset:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Main dataset: 406926 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define analysis date - day after the last transaction)</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>analysis_date <span class="ot">&lt;-</span> <span class="fu">max</span>(df<span class="sc">$</span>InvoiceDate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create RFM dataset</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>rfm_data <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>)) <span class="sc">|&gt;</span> <span class="co"># remove rows without Customer ID since we can't identify those customers</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recency- Days since last purchase</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Recency =</span> <span class="fu">as.numeric</span>(analysis_date <span class="sc">-</span> <span class="fu">max</span>(InvoiceDate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Frequency- Number of unique invoices/purchases</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frequency =</span> <span class="fu">n_distinct</span>(Invoice),</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Monetary- Total revenue</span></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Monetary =</span> <span class="fu">sum</span>(Revenue, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Monetary <span class="sc">&gt;</span> <span class="dv">0</span>)  <span class="co"># remove customers with negative or zero monetary value</span></span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rfm_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  `Customer ID` Recency Frequency Monetary
          &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt;
1         12346     165        11     373.
2         12347       3         2    1323.
3         12348      74         1     221.
4         12349      43         2    2221.
5         12351      11         1     301.
6         12352      11         2     344.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rfm_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Customer ID       Recency         Frequency          Monetary        
 Min.   :12346   Min.   :  1.00   Min.   :  1.000   Min.   :     2.95  
 1st Qu.:13885   1st Qu.: 18.00   1st Qu.:  1.000   1st Qu.:   307.39  
 Median :15352   Median : 53.00   Median :  2.000   Median :   695.92  
 Mean   :15351   Mean   : 91.07   Mean   :  4.444   Mean   :  2037.88  
 3rd Qu.:16835   3rd Qu.:136.00   3rd Qu.:  5.000   3rd Qu.:  1708.76  
 Max.   :18287   Max.   :374.00   Max.   :205.000   Max.   :349164.35  </code></pre>
</div>
</div>
</section>
<section id="analyze-the-distributions" class="level2">
<h2 class="anchored" data-anchor-id="analyze-the-distributions">Analyze the distributions</h2>
<p>There are some outliers, Recency is skewed to the right, Frequency is only slightly right skewed, monetary is really just at 0</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># histograms for each RFM component</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rfm_data, <span class="fu">aes</span>(<span class="at">x =</span> Recency)) <span class="sc">+</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recency Distribution"</span>, <span class="at">x =</span> <span class="st">"Days Since Last Purchase"</span>)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rfm_data, <span class="fu">aes</span>(<span class="at">x =</span> Frequency)) <span class="sc">+</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency Distribution"</span>, <span class="at">x =</span> <span class="st">"Number of Purchases"</span>)</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rfm_data, <span class="fu">aes</span>(<span class="at">x =</span> Monetary)) <span class="sc">+</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"coral"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monetary Distribution"</span>, <span class="at">x =</span> <span class="st">"Total Revenue"</span>) <span class="sc">+</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="standardize-the-data-for-clustering" class="level2">
<h2 class="anchored" data-anchor-id="standardize-the-data-for-clustering">Standardize the data for clustering</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dataset for clustering</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>rfm_for_clustering <span class="ot">&lt;-</span> rfm_data <span class="sc">|&gt;</span> </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Recency, Frequency, Monetary) <span class="sc">|&gt;</span> </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log transform Monetary to handle skew</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Monetary_log =</span> <span class="fu">log1p</span>(Monetary),</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Log transform Frequency for skew</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Frequency_log =</span> <span class="fu">log1p</span>(Frequency),</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Recency_log =</span> <span class="fu">log1p</span>(Recency)</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Recency_log, Frequency_log, Monetary_log) <span class="sc">|&gt;</span> </span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>() <span class="sc">|&gt;</span>   <span class="co"># Standardize variables</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Customer ID back</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>rfm_for_clustering<span class="sc">$</span>CustomerID <span class="ot">&lt;-</span> rfm_data<span class="sc">$</span><span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="determine-optimal-number-of-clusters" class="level2">
<h2 class="anchored" data-anchor-id="determine-optimal-number-of-clusters">Determine optimal number of clusters</h2>
<p>3 seems to be the most optimal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for clustering (remove CustomerID)</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>cluster_data <span class="ot">&lt;-</span> rfm_for_clustering <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>CustomerID)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate within-cluster sum of squares for different k values</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  kmeans_temp <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> k, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>  wss[k] <span class="ot">&lt;-</span> kmeans_temp<span class="sc">$</span>tot.withinss</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the elbow curve</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, wss, <span class="at">type =</span> <span class="st">"b"</span>, </span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Number of Clusters (k)"</span>, </span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Within-Cluster Sum of Squares"</span>,</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Elbow Method for Optimal k"</span>,</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Silhouette method</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>silhouette_scores <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  kmeans_temp <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> k, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(kmeans_temp<span class="sc">$</span>cluster, <span class="fu">dist</span>(cluster_data))</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  silhouette_scores[k<span class="dv">-1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sil[, <span class="dv">3</span>])</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot silhouette scores</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>, silhouette_scores, <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Number of Clusters (k)"</span>,</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Average Silhouette Score"</span>,</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Silhouette Method for Optimal k"</span>,</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="k-means-clustering" class="level1">
<h1>K means clustering</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>k_optimal <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(cluster_data, <span class="at">centers =</span> k_optimal, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster assignments back to original data</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>rfm_data<span class="sc">$</span>Cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(kmeans_result<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># analyze and interpret</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize clusters</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Analyze and Interpret Clusters (Updated with Wholesale naming)</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize clusters</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>cluster_summary <span class="ot">&lt;-</span> rfm_data <span class="sc">|&gt;</span> </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cluster) <span class="sc">|&gt;</span> </span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>(),</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Recency =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Recency), <span class="dv">1</span>),</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Frequency =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Frequency), <span class="dv">1</span>),</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Avg_Monetary =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Monetary), <span class="dv">0</span>),</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Cluster)</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Cluster Count Avg_Recency Avg_Frequency Avg_Monetary
  &lt;fct&gt;   &lt;int&gt;       &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
1 1        1764        54.4           3.4         1287
2 2         816        18.1          13.4         7300
3 3        1730       163.            1.3          321</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>cluster_summary <span class="ot">&lt;-</span> cluster_summary <span class="sc">|&gt;</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Segment =</span> <span class="fu">case_when</span>(</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Wholesale- high frequency and high monetary value</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>      Avg_Frequency <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> Avg_Monetary <span class="sc">&gt;=</span> <span class="dv">4000</span> <span class="sc">~</span> <span class="st">"Wholesale"</span>,</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># High-Value- Recent, decent frequency, good monetary</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>      Avg_Recency <span class="sc">&lt;</span> <span class="dv">100</span> <span class="sc">&amp;</span> Avg_Frequency <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">&amp;</span> Avg_Monetary <span class="sc">&gt;=</span> <span class="dv">1000</span> <span class="sc">~</span> <span class="st">"High-Value"</span>,</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Casual- Everything else</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Casual"</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  Cluster Count Avg_Recency Avg_Frequency Avg_Monetary Segment   
  &lt;fct&gt;   &lt;int&gt;       &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;     
1 1        1764        54.4           3.4         1287 High-Value
2 2         816        18.1          13.4         7300 Wholesale 
3 3        1730       163.            1.3          321 Casual    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># revenue contribution by segment</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>segment_analysis <span class="ot">&lt;-</span> cluster_summary <span class="sc">|&gt;</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Revenue =</span> Count <span class="sc">*</span> Avg_Monetary,</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Revenue_Percent =</span> <span class="fu">round</span>(Total_Revenue <span class="sc">/</span> <span class="fu">sum</span>(Total_Revenue) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Customer_Percent =</span> <span class="fu">round</span>(Count <span class="sc">/</span> <span class="fu">sum</span>(Count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Segment, Cluster, Count, Customer_Percent, Avg_Monetary, Total_Revenue, Revenue_Percent)</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(segment_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  Segment    Cluster Count Customer_Percent Avg_Monetary Total_Revenue
  &lt;chr&gt;      &lt;fct&gt;   &lt;int&gt;            &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
1 High-Value 1        1764             40.9         1287       2270268
2 Wholesale  2         816             18.9         7300       5956800
3 Casual     3        1730             40.1          321        555330
# ℹ 1 more variable: Revenue_Percent &lt;dbl&gt;</code></pre>
</div>
</div>
<section id="visualize-segments" class="level2">
<h2 class="anchored" data-anchor-id="visualize-segments">Visualize segments</h2>
<p>Casual and high value seem to have a bit of overlap due to their monetary values being more similar and frequency is not that far apart</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3D scatter plot</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(rfm_data, </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="sc">~</span>Recency, <span class="at">y =</span> <span class="sc">~</span>Frequency, <span class="at">z =</span> <span class="sc">~</span>Monetary,</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="sc">~</span>Cluster,</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">"markers"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Customer Segments in RFM Space"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-873249b169eb6149d57e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-873249b169eb6149d57e">{"x":{"visdat":{"62046ca025c7":["function () ","plotlyVisDat"]},"cur_data":"62046ca025c7","attrs":{"62046ca025c7":{"x":{},"y":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Customer Segments in RFM Space","scene":{"xaxis":{"title":"Recency"},"yaxis":{"title":"Frequency"},"zaxis":{"title":"Monetary"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[165,3,43,11,11,16,24,11,61,28,49,45,57,25,17,58,101,15,2,81,38,100,18,7,21,28,35,21,38,49,21,23,58,7,32,98,2,35,99,81,63,162,158,35,35,119,1,36,71,44,95,64,66,134,51,14,86,211,21,21,17,28,17,21,58,10,35,57,26,155,14,99,17,12,24,49,52,145,21,92,18,28,14,70,66,45,73,18,14,61,150,30,21,44,116,32,57,164,70,165,21,19,7,23,78,78,25,10,134,21,95,122,35,95,22,93,5,108,11,92,24,32,99,9,7,1,57,78,29,17,135,4,14,137,35,33,73,40,23,17,63,197,8,72,61,15,14,9,11,33,21,107,30,37,17,17,94,17,31,16,60,8,78,36,262,26,47,175,16,99,1,9,177,36,49,7,16,49,72,21,56,53,81,11,30,128,33,10,65,68,74,49,15,124,10,4,43,28,5,220,86,234,37,72,25,56,65,166,9,45,95,47,147,37,315,18,50,4,51,49,8,73,12,21,54,38,8,73,2,8,53,35,4,21,45,17,171,79,23,138,30,22,79,85,150,59,56,23,73,87,85,29,37,30,66,9,15,33,25,29,49,2,19,33,16,35,15,79,51,28,12,59,21,59,24,91,16,115,70,91,47,172,177,98,130,67,108,14,45,50,1,7,141,51,50,32,64,26,50,219,36,73,8,117,63,214,29,99,108,183,42,144,42,137,21,12,24,59,84,10,15,43,46,30,82,44,210,42,91,105,52,19,122,51,115,5,23,77,64,2,54,61,32,56,103,63,47,26,18,19,37,70,64,3,15,5,25,85,85,71,152,36,131,28,17,23,23,88,29,44,16,24,15,30,78,276,35,130,10,4,10,19,16,22,40,26,16,74,44,57,53,9,65,82,42,44,29,56,28,247,71,46,144,61,51,9,9,234,40,138,229,53,205,58,169,36,32,64,127,89,123,70,64,94,24,72,80,66,67,71,3,30,163,42,305,54,29,16,35,17,33,15,136,99,29,101,22,64,163,19,140,183,12,40,18,10,14,151,74,25,99,60,67,38,73,232,18,38,67,30,12,47,45,11,53,35,28,23,112,22,59,142,29,75,15,19,100,22,82,50,29,164,16,12,10,186,42,114,33,54,18,33,17,143,25,239,39,9,49,7,40,42,290,25,44,84,87,31,11,42,16,35,11,36,126,9,95,23,25,246,100,66,11,54,3,79,63,4,75,36,59,45,17,58,30,24,81,40,45,85,26,70,50,73,39,71,101,134,8,9,40,95,17,127,16,107,15,100,31,43,99,149,40,49,74,57,52,66,15,14,49,14,58,182,67,65,45,99,18,17,61,57,61,16,1,25,30,86,79,86,29,26,60,37,44,107,12,46,10,23,32,148,73,70,130,147,15,79,50,4,15,31,12,68,287,32,52,72,18,1,38,43,37,4,73,42,66,26,37,10,5,14,12,11,19,72,23,231,45,43,166,52,120,56,24,47,16,47,17,70,53,53,8,30,19,57,18,9,15,26,10,26,79,51,30,12,147,16,51,15,78,22,73,44,45,50,18,30,149,24,51,65,63,63,269,3,24,17,23,64,212,50,36,28,61,155,9,71,51,78,4,43,78,30,9,61,36,8,137,42,61,18,32,103,8,23,38,17,74,40,26,5,5,31,94,16,8,316,78,59,54,66,43,53,59,26,110,78,8,16,24,49,129,119,77,54,63,52,79,45,31,31,44,73,37,24,67,29,17,106,1,79,14,26,198,53,37,24,105,54,57,23,77,66,24,12,18,109,31,9,123,29,3,2,11,31,4,16,12,5,99,57,110,79,12,59,46,49,54,8,22,36,65,130,63,15,56,151,66,8,39,8,19,84,57,18,17,29,93,46,212,92,59,114,19,31,10,25,9,43,18,61,3,56,23,110,17,99,1,30,44,75,56,52,14,1,29,32,64,5,66,38,47,66,57,39,148,17,16,240,15,114,16,86,30,16,15,4,136,246,114,49,31,245,135,57,9,4,8,39,45,46,86,18,36,59,17,28,36,32,10,56,23,11,327,114,70,15,36,23,103,40,32,110,12,26,39,25,28,16,16,101,37,21,92,36,25,114,40,17,19,9,2,40,173,11,148,57,30,19,60,150,26,16,8,19,35,228,28,18,64,9,179,73,32,12,86,73,49,50,8,3,56,23,8,22,15,85,47,87,57,31,30,59,138,5,53,2,89,191,57,81,47,15,17,72,71,96,8,129,22,147,266,70,240,54,32,66,103,53,67,165,35,14,66,128,89,81,44,95,22,1,71,29,56,67,129,8,89,11,12,22,29,64,12,92,49,32,14,45,40,5,52,42,30,5,49,87,10,36,259,72,14,4,60,32,9,53,15,92,10,29,1,138,56,39,10,15,24,21,92,2,46,68,126,72,4,11,130,32,47,2,17,110,19,37,44,53,32,31,93,92,30,60,66,15,15,52,9,11,49,54,155,36,15,198,163,64,21,18,25,211,22,140,52,53,70,74,70,33,38,288,30,58,26,2,54,43,58,59,14,7,36,56,17,158,106,50,109,127,107,57,72,114,74,30,11,105,28,53,8,16,32,18,57,10,14,21,17,15,56,11,18,8,95,9,56,14,46,22,14,74,22,59,93,9,110,115,59,123,54,12,100,16,262,33,66,28,3,65,42,50,25,89,63,60,68,67,187,56,75,73,145,10,15,11,12,30,12,218,19,72,45,18,38,32,65,2,23,31,36,49,5,25,5,29,11,67,26,44,12,49,17,82,148,17,53,22,226,56,144,32,29,70,68,16,49,80,67,10,19,33,15,57,1,51,51,60,113,17,67,21,11,59,22,141,33,36,42,63,267,59,56,9,68,80,22,36,26,12,2,26,40,89,39,15,38,19,25,37,58,117,74,56,47,58,176,23,77,38,47,2,44,47,16,51,36,15,37,12,79,19,28,39,141,92,227,8,103,40,18,54,19,114,8,93,59,59,49,8,12,33,40,19,16,29,190,106,68,14,23,14,29,78,75,9,42,64,12,53,52,88,26,183,2,30,63,73,36,36,33,2,138,74,4,14,16,64,57,22,8,7,5,19,17,86,19,98,65,77,4,26,24,18,59,31,19,12,57,99,18,32,79,38,28,28,23,78,53,9,82,217,18,14,183,45,33,11,12,80,67,73,11,82,1,43,17,65,28,15,31,30,45,32,10,73,66,1,17,30,25,33,42,210,184,24,75,17,64,88,110,7,52,54,40,53,148,88,163,17,15,10,66,18,58,9,82,39,22,1,23,159,24,52,53,113,4,46,11,23,92,19,18,26,32,81,21,10,25,26,12,17,10,26,29,29,17,23,28,30,12,43,46,164,19,1,2,15,12,11,73,16,30,63,127,64,190,12,21,36,31,68,11,54,70,71,56,46,217,22,40,59,9,22,17,88,32,1,21,44,80,98,1,61,44,31,44,24,199,26,186,88,44,30,30,33,1,87,253,19,26,26,11,14,33,108,61,31,26,8,9,110,12,82,103,81,32,3,85,54,17,16,108,253,58,12,38,176,23,3,40,45,73,82,24,10,15,60,23,65,9,21,134,2,8,113,71,98,1,53,4,157,19,233,21,59,24,4,147,30,19,12,38,106,18,60,2,31,40,161,25,64,16,107,100,11,63,29,9,38,17,23,33,22,18,7,14,5,31,87,12,31,4,11,29,1,14,56,57,234,45,50,191,116,58,24,43,98,8,1,4,21,21,46,4,2,33,35,31,15,73,10,9,15,9,8,80,36,226,9,14,107,8,227,7,9,17,8,36,28,12,123,16,24,18,15,16,2,85,11,12,17,178,9,46,21,15,136,14,11,21,57,10,2,17,73,270,200,29,44,22,22,9,61,19,9,80,82,63,78,21,32,10,112,12,5,3,28,45,37,40,56,24,5,106,196,36,66,16,74,107,17,166,73,30,14,24,8,51,81,66,50,184,82,100,29,227,2,184,28,33,18,112,18],"y":[11,2,2,1,2,3,1,3,6,3,3,3,2,2,2,2,5,1,1,2,3,5,2,4,3,5,3,3,3,3,2,2,2,1,4,2,1,3,3,4,2,3,2,3,3,5,3,2,7,1,7,1,2,3,5,1,3,5,2,2,4,3,5,2,2,3,2,5,2,3,5,3,6,3,5,4,6,2,2,5,3,2,4,2,3,4,3,5,3,3,2,1,2,4,1,3,1,3,2,4,2,3,3,4,3,5,3,2,2,2,4,3,4,5,5,2,1,6,1,1,2,3,4,6,2,2,1,6,1,4,3,3,2,3,2,7,3,2,1,4,5,4,4,4,2,5,2,3,3,2,2,3,2,8,2,4,8,2,2,3,3,3,3,5,1,2,4,8,5,5,1,1,5,2,4,2,6,4,6,5,3,4,4,1,4,3,2,2,3,1,6,7,6,4,2,1,5,7,2,4,4,3,2,5,2,6,1,3,5,2,3,2,4,3,6,1,7,2,3,5,2,5,4,1,4,2,2,1,3,4,7,3,3,3,5,1,4,3,2,4,7,6,1,3,5,4,2,1,4,4,4,5,6,2,2,2,2,8,2,4,7,1,2,3,3,3,4,5,3,6,3,5,3,2,2,3,2,7,2,3,3,2,3,6,4,4,2,3,1,2,1,1,2,3,2,2,4,4,2,4,2,5,3,3,2,3,4,3,4,4,6,2,6,4,3,2,2,7,6,2,2,3,4,5,2,4,6,3,5,5,2,2,2,2,5,4,3,2,3,2,5,2,5,4,3,2,4,2,2,1,5,3,4,3,4,4,2,3,4,4,3,2,4,2,3,2,7,5,2,5,5,1,1,3,3,5,2,4,4,3,4,4,4,3,2,3,2,1,2,3,3,5,3,5,7,3,6,7,5,6,3,2,4,5,4,2,5,3,3,4,4,2,3,4,5,5,2,2,3,7,4,3,4,4,4,3,7,2,2,2,3,2,4,4,3,3,4,5,2,1,3,5,4,8,6,3,1,4,3,5,6,3,5,5,5,4,3,2,2,3,4,2,4,4,2,3,2,1,4,2,3,3,5,1,3,3,1,2,3,2,6,3,6,4,2,2,3,2,3,4,4,4,2,2,4,3,4,4,2,6,2,2,5,3,3,3,3,4,4,3,2,3,2,3,4,4,6,5,2,3,3,4,3,5,3,2,3,5,3,7,4,2,3,5,2,4,5,2,4,5,3,3,3,3,7,2,1,1,2,8,5,4,5,3,4,3,3,4,4,2,4,2,1,3,4,3,4,2,6,4,4,4,4,3,4,2,3,3,2,4,2,5,5,3,2,4,2,2,5,2,4,4,3,2,3,2,2,6,2,2,2,1,3,2,2,4,2,3,1,1,3,4,2,3,2,3,3,4,5,2,4,2,5,4,1,6,4,3,4,3,3,3,3,2,3,2,7,5,5,4,3,5,3,3,5,6,6,4,4,4,3,6,7,3,2,5,2,4,4,2,3,4,5,3,3,4,4,1,4,2,4,6,2,1,5,4,4,5,4,1,3,3,4,3,4,5,5,7,5,3,3,2,3,2,4,3,1,3,3,4,8,5,2,2,6,3,2,3,2,6,3,3,4,3,3,4,1,2,7,4,4,2,3,6,1,4,3,5,2,3,2,3,4,5,3,5,4,3,5,2,3,6,2,6,3,4,5,5,3,4,4,5,5,3,1,2,2,2,2,4,1,2,2,3,4,4,4,2,2,3,2,4,3,4,2,2,4,4,4,3,1,5,5,5,4,2,5,6,2,2,10,4,1,4,2,6,3,6,2,4,5,2,3,3,5,4,4,2,2,3,2,5,2,2,2,2,6,4,2,4,2,3,2,3,3,2,2,1,7,5,4,3,2,2,1,4,3,6,1,4,2,1,3,2,2,3,5,3,3,3,3,2,3,3,2,1,4,4,2,6,3,5,3,5,3,3,4,3,2,2,4,3,2,4,3,4,3,2,6,4,1,2,7,4,3,5,2,4,2,6,5,1,7,4,1,3,2,2,4,2,3,3,4,1,5,3,6,5,4,3,2,4,3,7,3,3,7,3,1,2,4,4,1,6,4,5,4,3,2,3,2,2,2,2,6,1,3,5,6,4,2,3,5,3,3,3,2,3,3,5,4,5,8,4,3,5,4,2,4,2,3,3,2,4,4,2,6,3,3,5,2,2,3,5,2,3,1,3,3,5,4,6,3,2,2,2,2,11,3,6,4,4,2,2,3,5,3,1,2,2,5,3,2,5,7,3,5,3,2,2,4,2,7,2,3,6,4,3,2,1,3,5,2,3,4,4,2,3,2,2,4,1,3,3,5,1,3,4,3,7,8,7,2,1,5,3,1,2,2,4,1,3,4,3,2,3,4,1,1,6,5,3,4,2,4,5,2,2,5,2,2,2,1,5,3,2,2,4,2,2,9,6,3,2,4,3,4,4,4,3,4,3,3,3,4,3,3,3,2,2,5,2,2,3,3,4,3,4,3,4,2,1,6,2,3,3,3,3,4,3,3,2,4,6,5,9,3,5,3,4,3,4,7,5,5,3,1,9,7,8,3,2,3,4,2,2,2,3,4,4,3,4,4,1,2,2,5,3,3,2,1,2,3,7,5,1,2,2,2,2,3,4,4,4,4,4,3,4,2,3,3,2,3,4,4,4,6,4,7,4,2,3,3,5,3,1,3,1,7,3,1,4,3,2,3,5,2,3,1,4,4,2,1,4,3,4,1,3,6,2,3,3,6,5,3,2,3,3,2,2,7,7,3,2,4,2,1,3,3,3,1,3,5,2,3,3,7,1,3,4,2,2,1,4,5,4,6,5,3,2,4,2,2,2,3,2,4,2,5,4,3,2,2,2,5,5,2,3,4,3,4,7,4,6,7,3,4,7,2,2,2,3,2,3,7,4,4,4,2,2,2,2,3,3,5,7,2,1,4,6,1,4,6,3,5,5,3,4,3,2,4,4,3,3,5,5,3,3,4,3,6,3,5,3,2,5,2,6,3,2,5,3,3,4,2,3,3,6,2,3,3,2,3,4,3,2,2,3,4,5,3,5,3,4,3,5,5,4,4,3,4,5,2,2,3,4,3,4,1,2,3,2,4,4,2,4,4,6,3,4,3,3,5,4,8,2,3,4,2,4,3,4,5,3,4,6,4,6,3,5,4,4,6,1,6,7,4,2,3,3,1,4,2,6,4,3,2,4,5,2,5,4,6,4,3,2,4,5,5,5,3,2,2,3,7,2,6,5,2,2,4,3,4,2,7,5,2,6,2,3,3,4,2,2,2,7,1,6,2,4,6,6,3,2,2,2,2,2,4,4,5,5,2,5,2,2,3,4,5,6,4,4,3,9,2,3,4,3,3,5,3,2,6,3,3,7,7,2,3,2,2,4,4,3,5,7,2,3,7,3,4,6,2,7,2,2,2,2,3,2,3,8,2,5,2,2,3,4,4,4,3,3,2,3,6,3,3,4,3,2,7,6,2,4,4,3,4,2,2,4,1,1,8,3,4,1,6,5,3,2,3,6,2,4,2,4,3,3,5,3,2,1,6,3,3,3,4,3,2,5,1,5,2,5,3,2,2,3,2,3,2,6,2,4,4,4,2,7,2,3,6,9,1,3,4,3,4,2,5,3,2,4,5,2,2,1,6,4,5,3,3,3,4,2,1,3,3,5,2,4,4,2,4,4,6,3,3,4,1,2,4,3,2,9,3,2,4,3,2,2,3,5,5,6,2,1,3,5,3,2,4,4,1,5,2,4,3,1,1,4,4,7,3,7,2,3,3,2,4,4,1,3,7,2,2,4,6,2,1,1,2,9,4,1,2,2,7,1,3,2,3,2,2,2,2,3,4,6,3,3,5,1,3,5,5,4,1,5,2,2,4,4,3,1,4,3,4,3,2,5,2,3,4,4,5,2,6,2,4,4,2,3,5,4,6,2,5,1,3,5,4,6,2,4],"z":[372.86000000000001,1323.3199999999999,2221.1399999999999,300.93000000000001,343.80000000000001,3126.25,11229.99,2519.0100000000002,2563.3600000000001,1310.8299999999999,1511.1500000000001,1819.4200000000001,2046.29,383.14999999999998,1718.2,692.98000000000002,6291.4899999999998,1668.4000000000001,258.89999999999998,1120.45,1433.3299999999999,2312.5300000000002,816.85000000000002,1868.6400000000001,808.64999999999998,941.29999999999995,2975.0599999999999,1287.22,1262.05,1352.6200000000001,391.00999999999999,667.08000000000004,1579.0699999999999,249.5,6096.04,739.20000000000005,155.55000000000001,490.31999999999999,3634.3600000000001,3383.0900000000001,715.09000000000003,2581.1999999999998,3070.54,7056.6300000000001,1949.22,1619.4300000000001,518.76999999999998,5043.4000000000005,1499.3900000000001,787.20000000000005,3635.4499999999998,3084.02,1102.5599999999999,883.73000000000002,1880.98,276.5,5618.4000000000005,1570.6800000000001,826.47000000000003,1041.1800000000001,556.87,746.88999999999999,995.94999999999993,1623.9400000000001,1469.04,1865.73,543.88,3775.98,759.29999999999995,2037.0599999999999,1681.8900000000001,1385.01,1138.1400000000001,1124.95,3202.6900000000001,3269.79,3046.7399999999998,2265.0599999999999,1198.22,2841.0700000000002,3226.1799999999998,1115.23,2318.4099999999999,706.26999999999998,1422.5800000000002,1584.1200000000001,738.95000000000005,1527.1399999999999,263.75,2104.6599999999999,1028.1600000000001,1248.4200000000001,692.24000000000001,1241.7,1858.9100000000001,703.11000000000001,901.67999999999995,789.01999999999998,731.90999999999997,1522.7,1248.95,1160.1099999999999,1906.76,1279.5,1464.8300000000002,6879.8000000000002,2040.9200000000001,493.25,3710.5,1698.6900000000001,4037.77,925.40999999999997,2806.48,7111.6500000000005,3207.3000000000002,737.95000000000005,320.07999999999998,1299.5799999999999,949.82000000000005,1895,270.07999999999998,848.45000000000005,384.89999999999998,788.50999999999999,387.85000000000002,468.08000000000004,1533.8900000000001,1808.8399999999999,1017.8099999999999,1230.95,2578.96,394.44999999999999,435.05000000000001,1621.8,444.94,1747.1800000000001,1315.2,799,765.36000000000001,2039.6700000000001,1950.4000000000001,1669.52,612.84000000000003,2581.5999999999999,1008.3199999999999,2271.3499999999999,1755.24,640,1676.95,1653.3,873.41999999999996,1013.76,1698.77,1419.4000000000001,640.13,385.46000000000004,509.5,297.75,508.91000000000003,1026,924.51999999999998,811.10000000000002,1647.8699999999999,3765.2000000000003,10953.5,612.89999999999998,1548.46,1698.5599999999999,1079.5,1593.3399999999999,258.75,304.04000000000002,4689.4300000000003,539.49000000000001,1322.0699999999999,2646.02,1072.73,1161.2,2100.0900000000001,2502.8200000000002,753.50999999999999,546,844.87,355.5,884.01999999999998,920.08000000000004,382.66000000000003,330.12,1310.99,1914.8,3240.1399999999999,2485.46,1229.95,757.72000000000003,679.79999999999995,427.74000000000001,3419.27,1833.3699999999999,279.91000000000003,1010.73,799.13,1556.54,503.63999999999999,2248.3000000000002,751.56000000000006,2820.3800000000001,1106.7,722.09000000000003,1055.05,393.05000000000001,522.89999999999998,418.07999999999998,1378.74,222.65000000000001,2017.2,439.33000000000004,1662.45,505.80000000000001,610.62,3721.4500000000003,748.46000000000004,1468.8,1217.5999999999999,916.12,2240.4699999999998,681.64999999999998,504.85000000000002,3138.04,791.96000000000004,805,2146.3800000000001,1624.8399999999999,778.41999999999996,1586.54,3946.1399999999999,359.69,1646.6400000000001,1271.0599999999999,1572.99,1240.6100000000001,1580.3,1778.79,2803.1999999999998,764.60000000000002,2617.9000000000001,805.92000000000007,571.34000000000003,643,1265.1299999999999,429,677.97000000000003,1400.1299999999999,897.51999999999998,399.30000000000001,1920.71,504.94999999999999,336.59999999999997,1141.0599999999999,373.16000000000003,1250.6200000000001,2300.7800000000002,590,241.66,1348.3299999999999,264.89999999999998,893.12,1507.77,927.61000000000001,415.56999999999999,1192.9400000000001,900.76999999999998,705.11000000000001,2278.77,1076.2,913.62,917.57000000000005,409.17000000000002,1890,679.39999999999998,1665.25,1015.74,2726.9299999999998,1958.5999999999999,299.39999999999998,3228.4099999999999,1553.6500000000001,1450.5,2303.3299999999999,731.36000000000001,498.10000000000002,308.28000000000003,754.87,2297.6599999999999,4274.9399999999996,422.80000000000001,1552.8800000000001,1164.5899999999999,2528.9000000000001,835.46000000000004,1131.45,872.50999999999999,1647.74,913.89999999999998,641.36000000000001,568.91999999999996,2244.6999999999998,1198.9000000000001,1103.6400000000001,800.66999999999996,1028.6600000000001,2252.04,1779.4200000000001,2047.1400000000001,658.31999999999994,1132.6200000000001,665.34000000000003,702.89999999999998,1295.25,1280.1600000000001,631.68000000000006,2312.6999999999998,2715,1002.35,2422.96,931.12,705.45000000000005,2235.1199999999999,823,1379.5899999999999,2215.7800000000002,627.82000000000005,476.92000000000002,1544.79,488.5,1688.54,1180.6800000000001,462.18000000000001,619.49000000000001,663.70000000000005,1136.6400000000001,2396.23,717.85000000000002,1831.8800000000001,938.01999999999998,632.38999999999999,785.25,537.59000000000003,374.63999999999999,465.14999999999998,349.50999999999999,3038.8499999999999,833.40999999999997,1083.6900000000001,520.02999999999997,622.07000000000005,1072,241.68000000000001,961.10000000000002,741.09000000000003,976.81000000000006,818.22000000000003,396.70999999999998,609.41999999999996,491.81999999999999,596.27999999999997,522.66999999999996,1044,1039.8500000000001,748.73000000000002,734.57000000000005,1818.71,462.07999999999998,449.81,1526.8800000000001,1928.1300000000001,1016.47,326.25,1393.5599999999999,1451.6600000000001,1475.77,1347.54,3386.3299999999999,1858.04,1711.6599999999999,556.18999999999994,529.75,337.04000000000002,11880.84,1626.0800000000002,2020.4000000000001,348.33999999999997,1323.47,2559.4499999999998,1263.7,1540.2,743.25999999999999,1773.5699999999999,3260,1009.35,746.57000000000005,724.73000000000002,487.03000000000003,6701.6400000000012,2034.3099999999999,1247.02,169.79999999999998,1320.0999999999999,1353.3099999999999,1076.8499999999999,881.51999999999998,2165.7600000000002,3502.48,1431.5,785.37,3094.3699999999999,1982.0899999999999,301.54000000000002,623.98000000000002,945.79000000000008,881.72000000000003,1542.0899999999999,447.44,542.49000000000001,913.46000000000004,836.29999999999995,1179.45,2114.71,1121.24,1061.8399999999999,572.73000000000002,422.19999999999999,524.64999999999998,1218.6099999999999,3070.3800000000001,1502,660.64999999999998,1025.0899999999999,2445.79,620.37,319.75,1931.3499999999999,1955,1310.3400000000001,753.52999999999997,1001.01,933.76999999999998,662.40000000000009,1482.6000000000001,919.57000000000005,649.32000000000005,1508.7,1191.53,1100.8800000000001,1563.4200000000001,1574.3300000000002,1043.5699999999999,863.56000000000006,1415.45,849.56000000000006,869.63999999999999,1275.8099999999999,903.87,1774.6800000000001,730.70000000000005,692.95000000000005,6116.9200000000001,563.08000000000004,721.27999999999997,992.40999999999997,854.14999999999998,1314.6600000000001,446.75999999999999,3125,222.21000000000001,458.25,477.98000000000002,538.39999999999998,438.89999999999998,996.61000000000001,846.54999999999995,1909.3099999999999,834.38,2546.3600000000001,599.77999999999997,682.53999999999996,609.84000000000003,759.98000000000002,895.7600000000001,566.70000000000005,1410.6800000000001,1675.8099999999999,1234.48,611.54999999999995,1443.03,1084.6800000000001,10396.5,1428.7,689.75,1509.5,2470.2800000000002,338.75999999999999,312.05000000000001,2190.8800000000001,917.42999999999995,891.01999999999998,1262.52,792.61000000000001,643.25999999999999,1070.0799999999999,388.82999999999998,651.79999999999995,13544.99,9530.0799999999999,555.37,4722.6000000000004,2174.0700000000002,2919.4400000000001,977.56000000000006,183.37,362.42000000000002,1190.3700000000001,1467.48,1398.8099999999999,1570.8099999999999,670.98000000000002,671.34000000000003,3857.8499999999999,1376.05,569.89999999999998,8421.4699999999993,721.64999999999998,624.43000000000006,597.33000000000004,4456.5799999999999,339.11000000000001,678.76999999999998,1550.6300000000001,1160.3099999999999,1603.5999999999999,868.33000000000004,906.29999999999995,446.10000000000002,847.75999999999999,901.93000000000006,1947.5,856.85000000000002,1119.6600000000001,1192.2,543.88999999999999,3084.6900000000001,847.77999999999997,2037.02,3017.75,745.5,1046.8399999999999,979.80000000000007,1441.55,1573.1299999999999,1253.78,471.13999999999999,635.88999999999999,730.37,350.99000000000001,1504.9300000000001,2854.73,824.27999999999997,1183.3900000000001,843.16999999999996,1189.3799999999999,982.94000000000005,628.43999999999994,1374.4100000000001,3851.0099999999998,2201.9100000000003,2196.71,456.39999999999998,1352.04,742.90000000000009,1341.5599999999999,1058.0800000000002,1428.28,1478.7,1370.3399999999999,868.96000000000004,687.31000000000006,474.10000000000002,701.61000000000001,757.13,1583.28,1077.2,1766.27,1088.9100000000001,1294.1700000000001,689.10000000000002,840.05000000000007,400.06,634.67999999999995,1175.78,860.08000000000004,875.30999999999995,920.80999999999995,620.73000000000002,854.54999999999995,707.78999999999996,1157.77,1503.2400000000002,1546.0699999999999,647.66999999999996,902.35000000000002,604.20000000000005,1251.6500000000001,1656.26,651.40999999999997,661.38999999999999,900.18000000000006,1220.9000000000001,2143.8400000000001,6781.8000000000002,3777.1999999999998,966.26999999999998,645.19000000000005,401.14999999999998,977.29999999999995,628.21000000000004,3537.8209999999999,659.15999999999997,2112.21,660,1276.6600000000001,982.86000000000001,1020.47,1674.98,749.06000000000006,257.28000000000003,1111.55,1273.47,1921.9100000000001,2746.9099999999999,1953.95,1323.6500000000001,1278.5,1901.25,598.51999999999998,1007.28,948.19000000000005,3543.6300000000001,1647.1700000000001,784.08000000000004,1066.03,1516.6500000000001,982.59000000000003,1038.03,1974.6900000000001,627.31000000000006,587.68999999999994,693.80999999999995,346.20999999999998,982.26999999999998,1991.49,2605.6199999999999,2660,2782.3400000000001,968,514.53999999999996,728.48000000000002,705.64999999999998,986.22000000000003,255,1318.3899999999999,474.54000000000002,937.15999999999997,884.63999999999999,604.32999999999993,877.70000000000005,951.75999999999999,788.88,1212.21,1170.3299999999999,588.22000000000003,462.75,1326.04,1018.71,2124.46,1994.47,1541.98,1416.96,2358.02,1379.52,1666.99,1946.28,523.60000000000002,612.64999999999998,645.15999999999997,913.95000000000005,1973.9400000000001,1674.4100000000001,462.14999999999998,1289.4400000000001,376.20000000000005,1462.8099999999999,4619.79,885.83000000000004,773.68000000000006,422.63,992.46000000000004,1620.0699999999999,688.95000000000005,593.47000000000003,880.96000000000004,2012.72,1085.9100000000001,746.04999999999995,973.06999999999994,597.15999999999997,593.88999999999999,1056.4200000000001,2389.6199999999999,497.25,1351.55,593.5,912.43000000000006,1914.8,1380.9100000000001,2761.2200000000003,406.56,1170,633.99000000000001,550.56999999999994,1502.98,549.99000000000001,519.28999999999996,449.13999999999999,935.44000000000005,2849.52,512.61000000000001,767.47000000000003,995.28999999999996,1676.5699999999999,1810.8199999999999,773.67000000000007,915.27999999999997,3512.6199999999999,1039.55,1468.26,901.06999999999994,1563.03,5874.6499999999996,2478.7310000000002,77.52000000000001,1230.4200000000001,2078.54,1511.7,736.59000000000003,816.60000000000002,1397.0799999999999,437,832.79999999999995,552.35000000000002,837.06000000000006,1774.1600000000001,1384.8800000000001,702.96000000000004,615.20000000000005,1404.6800000000001,1021.4,2845.6999999999998,1773.97,843.74000000000001,359.39999999999998,2873.77,666.13,1770,1612.5599999999999,4273.79,2322.4299999999998,531.49000000000001,746.55999999999995,758.97000000000003,515,723.95000000000005,1325,924.51999999999998,1518.8099999999999,1210.72,1058.1399999999999,566.89999999999998,960.63,1060.7,416.60000000000002,437.57999999999998,1641.3,460.25999999999999,111.25,869.00999999999999,592.61000000000001,2129.4499999999998,530.58000000000004,1461.6300000000001,402.50999999999999,604.37,2336.7999999999997,2411.6999999999998,560.07000000000005,1766.46,1285.04,1597.76,1254.4100000000001,2133.1199999999999,623.49000000000001,737.05000000000007,473.49000000000001,1744.6099999999999,817.46000000000004,2428.0799999999999,546.25,965.20000000000005,1771.04,1160.4100000000001,795.98000000000002,620.85000000000002,509.75,1163.3900000000001,639.55999999999995,934.19000000000005,2456.8600000000001,824.48000000000002,208.30000000000001,502.51999999999998,1388.47,2121.1799999999998,1033.8099999999999,3686.6100000000001,2085.6100000000001,1091.99,383.96999999999997,3475.7199999999998,431.11000000000001,1225.8700000000001,487.75,1496.6700000000001,569.22000000000003,948.93000000000006,816.93000000000006,510.72000000000003,283.19,991.79000000000008,1298.99,588.04999999999995,937.07000000000005,797.89999999999998,377.70999999999998,606.41000000000008,6001.4899999999998,683.92000000000007,845.00999999999999,383.06999999999999,1687.49,1269.0900000000001,2193.5599999999999,690.30000000000007,1293.72,2095,1893.9300000000001,2577.54,1362.6300000000001,1136.8900000000001,1182.3799999999999,1253.1800000000001,239.87,1839.52,732.90999999999997,961.90000000000009,816.55999999999995,1363.54,514.22000000000003,1290.03,369.34000000000003,225.15000000000001,2310.3800000000001,797.96000000000004,1634.6400000000001,492.47999999999996,1439.72,1388.8099999999999,767.90999999999997,1253.77,547.60000000000002,698.45000000000005,678.11000000000001,2242.8099999999999,1786.5699999999999,1352.96,4009.6599999999999,1211.75,1174.55,1293.72,1385.3800000000001,625.19999999999993,2233.8000000000002,1216.6600000000001,1376.0899999999999,586.10000000000002,1203.77,257.06,6798.7200000000003,588.5,743,1522.27,1944.5699999999999,668.97000000000003,954.75,1269.05,1254.21,1939.02,406.94999999999999,1260.3800000000001,1672.05,1236.48,962.97000000000003,847.08000000000004,2209.98,5373.5,1993.3399999999999,628.38999999999999,340.59999999999997,1285.3300000000002,2313.1799999999998,2480.8200000000002,402.5,1060.77,344.61000000000001,469.77999999999997,1116.72,551.41999999999996,3358.4000000000001,247.38,918.45000000000005,652.70000000000005,1274.02,1133.8,538.83000000000004,1466.5599999999999,2210.6399999999999,1515.8099999999999,816.45000000000005,953.89999999999998,552.38999999999999,1139.0999999999999,608.40000000000009,1496.5999999999999,1199.3099999999999,738.57000000000005,1604.21,3147.3600000000001,828.55000000000007,1702.1399999999999,2240.9000000000001,719.82000000000005,574.23000000000002,443.16000000000003,526.97000000000003,1354.3499999999999,612.75999999999999,1082.5999999999999,1399.3700000000001,226.03999999999999,906.14999999999998,867.60000000000002,1773.1099999999999,3533.77,648.39999999999998,1541.1900000000001,434.5,1170.1100000000001,1524.3399999999999,1014.48,898.87,654.09000000000003,453.93000000000001,658.01999999999998,456.70000000000005,3035.54,744.54999999999995,544.60000000000002,605.70000000000005,923.85000000000002,1815.72,1380.4400000000001,1570.1600000000001,2579.04,2225.9400000000001,577.8900000000001,13916.34,1223.1100000000001,1006.5400000000001,1059.1400000000001,715.5,1399.3599999999999,848.32999999999993,3582.6199999999999,1610.71,1995.6500000000001,933.84000000000003,1433.96,1369.8600000000001,1535.3699999999999,543.5,1513.8399999999999,913.62,758.66999999999996,1607.0599999999999,1671.9000000000001,3400.3299999999999,689.11000000000001,2766.4000000000001,2029.3399999999999,954.59000000000003,3882.1700000000001,890.94000000000005,1108.8199999999999,1539.24,1518.3499999999999,548.79999999999995,433.30000000000001,819.87,1236.4300000000001,1353.79,508.51999999999998,434.75,1449.1399999999999,1157.3,343.27999999999997,871.77999999999997,1027.1500000000001,535.64999999999998,156.74000000000001,549.28999999999996,339.33999999999997,987.95000000000005,1449.6199999999999,1702.3399999999999,810.08000000000004,205.99000000000001,270.71999999999997,404.13999999999999,466.07999999999998,369.5,2190.6599999999999,282.79000000000002,330.23000000000002,2945.3800000000001,1839.1400000000001,646.26999999999998,2304.1799999999998,501.20999999999998,388.63999999999999,410.94999999999999,451.29000000000002,418.05000000000001,1702.9800000000002,1810.27,680.62,1315.7,2180.6399999999999,4194.8199999999997,1572.8600000000001,230.84999999999999,372.50999999999999,1217.9400000000001,854.61000000000001,775.11000000000001,626.22000000000003,583.38999999999999,2146.3899999999999,1373.2,1574.5,467.88999999999999,1341.95,289.23000000000002,532.25,1113.74,1970.45,491.01999999999998,1797.9200000000001,1103.3499999999999,1067.8499999999999,1082.6000000000001,2094.23,818.79000000000008,787.88999999999999,2122.8899999999999,1327.98,1591.73,541.95000000000005,1709.8299999999999,3395.29,750.56000000000006,3744.5700000000002,385.40000000000003,1033.8,1739.9200000000001,1437.4300000000001,271.44,770.08000000000004,1264.3500000000001,841.29999999999995,1938.46,2049.23,1393.4200000000001,907.16999999999996,422.19,4376.25,1297.45,1747.77,609.98000000000002,316.92000000000002,1523.49,1396.05,987.48000000000002,1527.25,910.35000000000002,832.42000000000007,2023.9100000000001,3309.2600000000002,796.89999999999998,628.32000000000005,884.59000000000003,1386.1200000000001,744.34000000000003,1237.2,798.85000000000002,2052.6900000000001,1915.3599999999999,5995.6899999999996,3354,739.10000000000002,308.59999999999997,2016.71,942.75,2136.7199999999998,521.63999999999999,538.52999999999997,1069.23,1884.1600000000001,543.57000000000005,1102.3499999999999,417.05000000000001,890.81000000000006,1857.26,1078.22,1722.0899999999999,1186.4000000000001,1078,1056.6300000000001,827.25,401.94,3626.29,985.13999999999999,361.94,312.62,755.14999999999998,837.52999999999997,1488.1700000000001,896.05999999999995,2033.78,357.94999999999999,1591.24,1818.79,1361.96,1139.28,2833.0100000000002,864.48000000000002,2069.3000000000002,951.50999999999999,1313.6700000000001,487.5,1392.4300000000001,2567.6399999999999,560.54999999999995,1194.9200000000001,2560,460.07999999999998,1491.4000000000001,4590.5299999999997,1703.0699999999999,382.42000000000002,2037.7,417.20999999999998,2774,3517.6900000000001,976.99000000000001,1878.9200000000001,741.31999999999994,1137.4200000000001,733.71000000000004,416.35000000000002,204.09999999999999,892.15000000000009,946.83000000000004,1220.8299999999999,557.90999999999997,1111.1500000000001,960.67999999999995,309.49000000000001,1298.4200000000001,2306.48,774.44999999999993,474.72000000000003,785.38999999999999,824.19000000000005,1103.6099999999999,541.86000000000001,211.80000000000001,694.72000000000003,695.53999999999996,495.39999999999998,266.78000000000003,433.45999999999998,1921.48,426.67000000000002,526.26999999999998,660.27999999999997,817.09000000000003,1219.49,1011.5700000000001,301.25,653.23000000000002,372.22000000000003,1463.8,746.24000000000001,2869.1599999999999,1696.21,966.02999999999997,789.60000000000002,1931.03,303.69999999999999,801.65999999999997,780.46000000000004,731.25,443.05000000000001,1237.23,868.75999999999999,1589.1700000000001,475.05000000000001,341.18000000000001,1148.01,2497.8600000000001,1044.3800000000001,1556.75,1053.74,2007.8399999999999,407.83999999999997,350.51999999999998,1315,2004.6200000000001,1629.79,2206.9700000000003,3345.02,599.35000000000002,1020.9000000000001,1331.03,850.34000000000003,540.87,297.94999999999999,2227.5900000000001,998.83000000000004,1361.28,605.89999999999998,741.11000000000001,1450.02,329.48000000000002,439.44999999999999,357.66000000000003,1288.72,1655.6400000000001,2057.77,673.60000000000002,1712.1200000000001,1579.97,885.78999999999996,1320.95,1892.52,3802.04,1397.6900000000001,2753.8499999999999,611.89999999999998,986.63,555.70000000000005,608.86000000000001,769.77999999999997,880.62,663.30999999999995,638.69999999999993,717.45000000000005,994.60000000000002,1110.8299999999999,551.11000000000001,1217.45,621.56000000000006,640.24000000000001,712.48000000000002,706.38999999999999,1164.5999999999999,3783.8899999999999,2956.5599999999999,2015.1700000000001,4387.0799999999999,207.5,1403.75,1072.97,420.75,2493.1999999999998,1230.03,761.36000000000001,1162.03,1720.79,3723.5500000000002,932.92999999999995,1081.4100000000001,623,788.92999999999995,1035.4300000000001,1352.8199999999999,513.08000000000004,868.19999999999993,1827.77,848.71000000000004,1002.29,812.74000000000001,1912.6500000000001,1901.71,1051.71,387.18000000000001,881.59000000000003,1302.51,1357.5599999999999,530.5,2136.2399999999998,1130.2,1408.96,1184.5999999999999,1610.6199999999999,772.83000000000004,662.33000000000004,495.72000000000003,393.38999999999999,533.11000000000001,2139,465.83999999999997,437.14999999999998,952.23000000000002,255.84,1324.0599999999999,902.28000000000009,507.56,439.45999999999998,689.03999999999996,869.02999999999997,1904.9300000000001,921.5,547.13999999999999,1191.0999999999999,629.39999999999998,1160.0599999999999,535.10000000000002,3377.7800000000002,1222.04,548.73000000000002,433.75,631.16999999999996,790.74000000000001,1536.3800000000001,560.38999999999999,786.25,926.12,496,1007.74,910.85000000000002,1041.21,1950.95,666.65000000000009,406.30000000000001,1077.8199999999999,830.15999999999997,1012.22,854.53999999999996,1367.5999999999999,1182.22,800.17999999999995,1152.8699999999999,436.81999999999999,1593.8299999999999,1421.3,2393.5,3004.5999999999999,538.39999999999998,604.71000000000004,881.37,488.24000000000001,1264.05,1188.3299999999999,1146.3299999999999,1462.95,467.25,669.85000000000002,2177.3899999999999,1372.1700000000001,1407.6099999999999,401.66999999999996,669.90999999999997,674.23000000000002,2728.1799999999998,2644.0099999999998,2253.2199999999998,1105.53,3817.1799999999998,1248.0899999999999,386.02999999999997,591.07000000000005,885.32000000000005,491.23000000000002,5259.9899999999998,410.42000000000002,2322.5900000000001,1923.99,432.18000000000001,631.87,1065.6900000000001,1155.03,1272.8,9730.0900000000001,814.42999999999995,1133.6299999999999,754.33000000000004,704.75,924.11000000000001,3120.9099999999999,1485.3599999999999,640.75999999999999,1635.6400000000001,867.11000000000001,178.68000000000001,638.80999999999995,795.47000000000003,1460.95,225.45000000000002,2118.7000000000003,1298.3,610.74000000000001,521.65999999999997,356.71000000000004,899.40999999999997,2012.03,615.26999999999998,1283.5,1250.8600000000001,446.74000000000001,1013.13,687.38999999999999,806.94999999999993,1754.24,871.13999999999999,529.14999999999998,500.72000000000003,417.30000000000001,970.25,537.46000000000004,797.84999999999991,1140.5799999999999,1080.25,1134.98,976.19999999999993,459.13999999999999,393.63999999999999,1151.04,4511.7600000000002,247.84,1025.0999999999999,2181.71,1040.3199999999999,922.59000000000003,644.51999999999998,512.76999999999998,838.26999999999998,508,119,1108.47,1227.54,1066.3,1066.9400000000001,1316.8899999999999,741.5,619.971,1401.0799999999999,1502,1750.3999999999999,768.25,500.19999999999999,645.59000000000003,711.81000000000006,940.86000000000001,1096.24,913.47000000000003,520.58000000000004,645,836.88,1432.01,381.15000000000003,2547.0900000000001,646.44000000000005,560.13999999999999,1471.52,485.60000000000002,1059.4100000000001,1615.3900000000001,3040.5100000000002,832.53999999999996,469.41000000000003,1385.6299999999999,317.75999999999999,1034.3199999999999,1030.4100000000001,975.56000000000006,2542.79,607,489.86000000000001,1272.8,658.17999999999995,1141.8399999999999,287.25,1289.6400000000001,2542.8299999999999,645.60000000000002,978.43999999999994,554.85000000000002,739.20000000000005,756.50999999999999,1445.47,1226.5699999999999,1011.7,960.69000000000005,802.58000000000004,727.85000000000002,627.96000000000004,2280.48,2270,574.48000000000002,1040.8500000000001,554.72000000000003,1024.55,496.26000000000005,903.87,329.55000000000001,1275.4300000000001,4067.1199999999999,960.23000000000002,1699.3499999999999,550.70000000000005,1504.7,1439.72,409.98000000000002,305.46999999999997,2348.1599999999999,1398.76,636.57000000000005,333.81,782.12,1529.49,403.60000000000002,489.59999999999997,1795.22,1856.6200000000001,725.14999999999998,4020.8000000000002,641.39999999999998,470.16000000000003,732.55000000000007,1265.5799999999999,506.67000000000002,1112.2,439.69999999999999,418.87,1758.52,1013.5400000000001,835.33000000000004,1319.6399999999999,1895.1900000000001,2735.6300000000001,830.63,2600.46,300.66000000000003,1585.5,313.05000000000001,731.19999999999993,819.00999999999999,2557.3499999999999,317.07999999999998,489.65000000000003,1412.8499999999999,980.70000000000005,1319.6700000000001,456.90000000000003,620.85000000000002,533.55999999999995,1198.0899999999999,1257.1800000000001,2006.3199999999999,1092.0599999999999,1362.75,741.69000000000005,426.90000000000003,1743.3700000000001,326.74000000000001,793.93000000000006,390.56,733.70000000000005,1555.8299999999999,441.92000000000002,631.34000000000003,804.82000000000005,299.61000000000001,1236.3299999999999,2102.6399999999999,338.56,679.01999999999998,736.27999999999997,818.06000000000006,664.09000000000003,1205.4400000000001,798.32999999999993,385.23000000000002,437.87,433.73000000000002,1617.3199999999999,591.96000000000004,75.760000000000005,420.17000000000002,2188.5,494.25,731.96000000000004,3867.5,730.47000000000003,598.19000000000005,457.96000000000004,1563.3399999999999,548.87,1608.1900000000001,760.19000000000005,208.97,1803.2,762.74000000000001,948.19000000000005,326.81999999999999,424.18000000000001,607.98000000000002,1213.8,963.09000000000003,3424.02,1032.8799999999999,313.45999999999998,708.76999999999998,571,1168.26,1596.98,574.20000000000005,244.08000000000001,638.20000000000005,540.35000000000002,1128.72,627.54000000000008,819.61000000000001,651.50999999999999,261.75999999999999,875.99000000000001,234.22,610.69000000000005,1117.27,353.19,1277.49,1038.5899999999999,805.07000000000005,288.42000000000002,896.76999999999998,1634.8299999999999,419.38,482.32999999999998,639.24000000000001,348.83999999999997,536.61000000000001,249.91999999999999,358.61000000000001,553.18000000000006,1898.49,424.24000000000001,476.90000000000003,983.67999999999995,1177.72,2074.0700000000002,462.10000000000002,370.81999999999999,546.34000000000003,97.400000000000006,579.16999999999996,316.45999999999998,342.69,556.51999999999998,2282.2800000000002,10877.18,1203.5599999999999,1185.46,912.14999999999998,1122.4000000000001,1019.4400000000001,508.47000000000003,722.44999999999993,955.80000000000007,2346.1900000000001,3374.2200000000003,1723.04,894.13,1965.52,550.84000000000003,405.50999999999999,1030.76,736.26999999999998,1079.4000000000001,181.12,567.71000000000004,847.02999999999997,882.47000000000003,1012.63,1226.0899999999999,533.40999999999997,206.22999999999999,1206,875.45000000000005,823.13999999999999,1279.55,963.59000000000003,3188.2000000000003,775.17999999999995,344,1780.3399999999999,1948.1500000000001,1616.48,1480.8600000000001,913.11000000000001,588.75,913.89999999999998,1372.72,568.63999999999999,839.73000000000002,1015.42,2262.52,2059.6700000000001,428.06,1464.73,168.59999999999999,1307.4000000000001,1320.6600000000001,1069.6700000000001,641.76999999999998,1296.4300000000001,2345.71],"mode":"markers","type":"scatter3d","name":"1","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[56,11,46,30,1,9,2,31,31,10,5,14,33,1,212,14,14,10,24,14,7,3,9,7,10,1,21,3,9,14,11,3,1,1,19,4,2,1,24,5,5,1,1,2,7,10,30,1,63,25,9,3,5,18,33,1,15,4,2,29,14,16,11,15,18,22,1,2,14,22,30,64,60,40,22,7,10,21,35,128,9,2,49,5,2,2,7,60,4,1,9,24,1,2,15,1,2,11,22,21,25,16,3,5,33,30,2,36,17,19,53,57,1,1,2,5,50,8,28,21,1,64,1,2,53,15,15,7,8,18,66,9,10,17,2,4,10,12,3,8,4,4,11,7,2,15,12,64,16,14,51,33,4,18,9,18,11,23,2,10,35,49,10,18,36,2,16,52,21,19,107,10,9,8,23,12,16,3,2,5,3,2,3,8,10,15,5,5,2,2,1,17,23,23,3,11,39,10,268,15,52,28,8,16,15,3,1,29,1,2,2,10,15,15,10,9,32,100,2,1,2,22,9,8,23,2,2,10,74,66,5,4,10,11,24,71,11,18,3,19,24,17,7,15,5,17,8,28,21,7,47,4,2,67,1,46,31,47,3,16,46,4,11,1,9,11,56,3,8,8,8,7,30,60,5,4,15,10,39,1,1,10,8,25,18,64,8,25,15,9,40,64,1,32,47,33,31,15,16,12,15,26,60,33,2,103,15,10,31,10,52,1,30,7,9,16,1,15,15,1,7,28,3,24,3,45,2,4,17,2,26,10,2,5,2,15,4,24,10,9,60,16,2,31,12,26,19,1,7,2,10,3,1,11,40,25,32,15,15,45,1,16,3,2,137,5,3,30,2,22,4,15,61,15,12,3,4,1,3,8,2,58,115,21,15,16,28,21,4,10,26,25,2,108,10,50,32,8,36,1,14,1,29,9,56,2,8,4,1,19,73,10,2,2,5,3,1,54,128,7,1,10,31,21,5,10,5,22,9,18,2,4,1,15,15,36,24,30,12,8,12,14,1,5,22,12,2,1,8,4,26,19,26,63,29,2,145,14,8,32,1,53,2,15,1,15,5,17,23,8,8,11,2,15,112,7,15,10,21,5,8,3,12,1,3,4,9,5,23,4,19,5,3,14,2,11,5,8,3,15,37,1,4,29,17,11,18,12,2,7,2,17,8,5,3,1,2,16,3,11,9,25,54,3,15,16,11,12,5,24,8,18,4,1,5,31,8,30,11,18,23,30,4,9,3,38,2,5,17,1,23,21,3,16,60,19,5,24,47,5,3,5,29,31,15,16,5,26,7,9,11,19,7,49,10,31,8,1,2,9,8,33,4,32,11,2,15,31,11,10,35,8,4,40,4,56,4,29,15,25,2,59,36,15,4,2,2,5,4,2,7,29,128,19,24,8,3,2,1,19,1,5,4,5,58,4,65,7,7,3,7,1,58,4,11,9,25,17,29,3,15,5,40,12,81,23,12,1,4,10,11,5,4,9,12,3,19,25,25,71,12,116,10,4,10,5,2,4,4,3,199,25,8,7,21,5,4,2,3,30,31,29,11,4,2,11,2,9,12,22,17,1,4,10,7,5,45,2,57,8,29,3,4,17,133,23,3,15,8,36,3,3,16,17,3,4,1,8,1,8,21,45,4,57,15,19,15,30,1,53,11,3,2,2,4,8,2,32,18,17,2,32,3,18,8,3,31,10,10,4,19,25,8,7,10,7,1,1,53,8,5,21,5,11,9,4,10,2,3,9,36,4,23,29,33,81,7,1,3,8,1,138,2,1,51,21,1,23,3,2,82,24,19,1,10,2,15,1,1,5,9,18,8,10,23,38,4,23,1,14,2,42,15,81,2,10],"y":[4,7,11,11,5,11,5,20,3,47,13,11,7,5,29,11,10,12,9,15,4,7,13,12,6,16,5,26,10,5,7,23,22,8,5,9,19,10,7,5,16,142,10,3,7,6,13,6,41,11,9,13,17,22,6,11,5,9,39,8,7,42,8,12,14,9,5,33,7,12,7,10,18,20,18,18,8,13,9,10,17,19,9,16,8,32,19,12,109,13,48,18,14,14,6,12,7,8,8,12,14,12,10,10,10,6,30,13,7,6,7,9,17,5,18,14,10,7,6,13,34,8,14,7,5,6,11,46,15,12,11,9,7,6,5,38,6,10,11,18,6,5,7,6,5,10,17,10,7,9,11,10,35,14,11,7,12,9,14,7,7,8,11,7,8,5,5,10,8,14,8,9,94,13,10,9,6,10,10,39,11,37,6,54,16,7,13,7,10,6,15,6,7,9,5,23,10,10,5,11,9,9,11,12,8,14,18,6,6,10,8,7,10,9,17,7,7,8,14,27,6,23,13,10,9,15,13,12,9,10,9,16,10,9,7,21,12,15,11,7,7,6,102,9,5,9,9,15,9,11,9,4,7,10,8,12,16,6,11,12,7,6,38,19,5,8,10,14,9,5,12,6,8,9,8,5,10,13,7,5,9,7,5,10,10,8,7,8,6,6,11,8,69,10,7,8,6,8,23,6,22,8,20,9,102,8,7,9,7,73,15,31,6,43,8,8,13,12,9,11,7,11,4,24,19,8,8,7,14,6,9,6,11,6,7,6,13,10,8,21,12,9,8,13,16,12,18,7,9,5,6,10,205,9,7,7,21,13,7,8,7,6,6,29,13,10,8,10,7,6,47,18,10,6,10,86,23,8,8,18,6,8,9,12,12,7,8,9,14,6,9,11,4,10,7,10,8,20,14,10,7,6,8,26,6,12,6,6,121,8,9,8,6,4,4,6,22,7,11,6,7,6,7,6,5,6,15,7,5,7,19,5,18,7,7,8,15,15,6,12,12,8,22,14,10,8,26,5,17,8,8,13,24,8,7,9,13,6,15,8,7,8,8,9,12,7,8,18,8,9,26,6,12,11,31,21,11,9,13,18,16,16,9,26,9,10,10,17,14,6,12,7,22,5,7,6,11,9,10,10,13,6,21,11,5,6,12,8,14,39,4,18,47,8,7,8,4,7,6,7,8,16,8,14,11,6,6,23,7,8,6,11,25,5,40,14,15,7,11,10,9,8,19,7,7,10,7,4,7,8,10,6,6,5,9,10,11,9,12,16,7,11,9,8,11,7,59,13,6,9,12,8,5,17,6,7,6,4,23,7,4,24,14,21,10,19,10,7,12,7,11,5,6,9,5,15,6,9,27,9,13,13,22,9,13,18,9,5,8,11,8,9,13,24,9,29,6,32,26,8,3,16,5,11,19,10,6,18,7,7,11,5,10,14,13,13,7,5,14,8,11,5,7,13,9,8,8,13,8,11,10,5,27,6,23,11,7,6,13,10,6,17,11,11,5,6,7,9,7,7,10,15,7,17,12,44,5,7,16,8,11,9,5,4,9,9,8,12,17,7,20,60,12,27,7,12,8,11,8,10,15,8,18,9,46,6,7,9,12,12,7,8,9,7,31,10,9,10,23,20,14,6,7,13,12,8,5,9,10,10,7,40,5,28,6,6,8,8,19,10,17,13,7,7,8,8,9,11,8,28,7,10,8,11,8,6,10,91,21,155,19,10,7,26,14,18,17,11,8,10,12,39,8,8,12,6,74,6,9,62,17,18,12,4,14,8,20,8,6,19,9,15,6,5,10,8,15,8,89,13,8,7,11,6,32,7,8,12,15,15,10,23,13,8,5,17],"z":[12346.620000000001,19543.84,2791.8099999999999,4014.2399999999998,3591.5100000000002,4145.5200000000004,7205.3900000000003,6834.9899999999998,12931.440000000001,17822.540000000001,10426.48,4616.6599999999999,6452.9899999999998,6171.0699999999997,23691.400000000001,2181.5999999999999,3904.71,2330.3800000000001,5848.3900000000003,7670.25,6725.1800000000003,3858.5799999999999,6590.0599999999995,2137.8800000000001,2057.0100000000002,10114.139999999999,4807.7799999999997,11769.530000000001,2830.2400000000002,6790.5299999999997,16373.719999999999,15532.74,10665.690000000001,3788.21,4731.8100000000004,2295.1900000000001,20816.82,2473.5300000000002,8520.8500000000004,2190.9400000000001,5080.5299999999997,22499.779999999999,5218.71,2658.6500000000001,2740.9099999999999,1923.3199999999999,4742,1481.03,6043.3100000000004,3972.7600000000002,2715.3499999999999,4480.3100000000004,3518.3299999999999,4881.6499999999996,3876.4699999999998,3085.52,2721.48,4217.2300000000005,19333.950000000001,1535.7,2242.1900000000001,50291.379999999997,2083.1599999999999,13683,11359.48,2149.6500000000001,1744.96,4782.8800000000001,2417.7799999999997,8870.880000000001,2354.27,2729.8400000000001,6627.6400000000003,14353.280000000001,5994.9399999999996,7814.8299999999999,2270.8600000000001,10423.200000000001,3033.8800000000001,4293.4300000000003,5557.6199999999999,6507.6700000000001,2119.77,5247.0100000000002,2335.4000000000001,16904.510000000002,30867.77,3722.1199999999999,57912.029999999999,5192.2700000000004,47111.18,7378.8000000000002,5272.8299999999999,6379.7699999999995,3199.9200000000001,1658.9000000000001,1898.6100000000001,3666.9500000000003,4062.29,5279.8299999999999,4914.6900000000005,7587.1999999999998,2285.7000000000003,6677.8100000000004,8333.7199999999993,3078.4000000000001,6615.7700000000004,8377.3199999999997,1531.9000000000001,2330.9400000000001,3264.23,9796.2299999999996,3553.8099999999999,1074.8700000000001,5236.7700000000004,3545.4699999999998,2959.73,1753.8499999999999,7213.8400000000001,4212.4110000000001,11236.950000000001,3391.52,6251.71,4323.9700000000003,11364.08,4585.0600000000004,4101.6800000000003,23616.421999999999,6106.1700000000001,4526.0600000000004,3881.8899999999999,5701.5,2076.3200000000002,4214.7700000000004,1847.5899999999999,7685.54,2026.28,2560.98,6619.5699999999997,3350.7400000000002,3329.3899999999999,972.27999999999997,2766.73,2685.0500000000002,1254.72,1850.8199999999999,4006.1700000000001,3238.8499999999999,1638.28,4849.9099999999999,2448.2000000000003,1678.8599999999999,15500.530000000001,2454.2200000000003,4834.4000000000005,1796.6800000000001,4367.6700000000001,3486.6100000000001,5013.96,2147.73,5854.8400000000001,5578.5,3498.3099999999999,1637.3299999999999,1759.0699999999999,1332.28,3600.6700000000001,3321.6799999999998,1352.3499999999999,6726.3500000000004,7713.25,2011.8199999999999,131443.19,7403.9499999999998,1839.03,6927.9800000000005,1954.9200000000001,4017.9800000000005,6226.4300000000003,18320.170000000002,3003.9100000000003,30501.260000000002,3128.54,38683.019999999997,21659.689999999999,1615.8199999999999,4820.5900000000001,1274.3599999999999,2244.29,2080,4144.4399999999996,5006.6199999999999,2941.1399999999999,3027.5799999999999,1171.8900000000001,28019.580000000002,3885.54,2809.1399999999999,34023.260000000002,1654.0799999999999,2651.4499999999998,4019.8499999999999,6009.3400000000001,9572.4500000000007,4709.2300000000005,2347.3299999999999,4311.9300000000003,2832.5599999999999,2573.7799999999997,4505.0200000000004,1128.0899999999999,2960.73,3309.3499999999999,2508.3200000000002,5600.4499999999998,2487.0100000000002,7062.1999999999998,4057.9000000000001,5902.1999999999998,23712.310000000001,1874.6800000000001,9030.6499999999996,9653.2800000000007,2946.4200000000001,7557.3099999999995,6823.6100000000006,3378.6599999999999,15139.35,22710.200000000001,1978.6800000000001,4435.5799999999999,5656.4300000000003,3152.54,2661.54,3985.1399999999999,7304.8000000000002,5252.1900000000005,11123.35,4953.6099999999997,5259.3000000000002,2106.7999999999997,5115.0799999999999,196566.73999999999,3245,2208.3600000000001,1669.9300000000001,1570.73,7321.0699999999997,2919.8400000000001,3955.6800000000003,2161.1900000000001,1626.6099999999999,1411.9100000000001,1882.3200000000002,4842.2799999999997,5625.4610000000002,19381.360000000001,12991.610000000001,4120.3199999999997,4020.8499999999999,4354.3199999999997,2221.3699999999999,39667.190000000002,10533.870000000001,2075.3099999999999,4912.3800000000001,2285.04,2443.77,3488.1599999999999,1747.01,4700.3000000000002,1633.9400000000001,2113.1599999999999,2744.4200000000001,1424.79,1696.6400000000001,6191.3199999999997,6007.8800000000001,7246.2700000000004,895.84000000000003,4281.0500000000002,2898.8000000000002,1575.7,2646.1799999999998,4610.4399999999996,2887.4100000000003,2374.5,1622.23,2289.7600000000002,2129.4200000000001,6096.1999999999998,3908.4400000000001,19283.48,3271.4899999999998,2926.3299999999999,1824.0599999999999,3166.54,2799.0799999999999,11276.440000000001,2619.8099999999999,3876.2599999999998,1654.6300000000001,3006.6199999999999,3094.02,18704.41,7568.1300000000001,1567.79,3598.25,2619.6500000000001,247613.5,4546.8599999999997,12685.940000000001,5808.5500000000002,28658.66,2082.6999999999998,1153.54,3462.0799999999999,3965.29,1316.46,2752.5099999999998,934.75999999999999,2814.5799999999999,6599.0600000000004,6174.4700000000003,8385.2199999999993,2712.8499999999999,2785.0999999999999,1736.5699999999999,4962.2700000000004,4082.7600000000002,5097.1300000000001,1781.5599999999999,2867.1500000000001,3434.5799999999999,1237.6500000000001,2895.2000000000003,2698.1700000000001,7699.6999999999998,3867.2400000000002,7832.9099999999999,3310.4900000000002,1254.9400000000001,6460.3199999999997,2241.7800000000002,2619.6999999999998,3038.4500000000003,13980.83,1623.6500000000001,2204.29,868.36000000000001,1355.24,2664.6900000000001,152147.57000000001,1503.77,4345.6599999999999,3884.4200000000001,9529.8600000000006,9365.4699999999993,1676.6800000000001,3327.29,1387.4499999999998,1732.0599999999999,3175.52,7789.6300000000001,2365.02,5367.9200000000001,2414.1799999999998,2488.4400000000001,8821.5499999999993,4004.79,20116.990000000002,8504.1000000000004,2598.6199999999999,2543.5500000000002,2185.8499999999999,83284.380000000005,8018.7700000000004,2871.7399999999998,1460.9200000000001,9729.0900000000001,2018.6999999999998,2863.6900000000001,5496.3900000000003,3412.7800000000002,5579.8699999999999,1494.5999999999999,5284.9700000000003,2376.1020000000003,4811.1599999999999,1853.7,2572.3800000000001,5759.6800000000003,2062.1999999999998,2965.9099999999999,2753.4099999999999,9839.5499999999993,2838.5700000000002,7377.46,6145.3699999999999,2202.4699999999998,6211.4200000000001,1576.6100000000001,2553.0599999999999,9178.2600000000002,6669.9700000000003,4659.4700000000003,3484.5300000000002,2533.0900000000001,56003.260000000002,2005.3400000000001,3961.4200000000001,1934.6300000000001,4892.6800000000003,1162,1778.1800000000001,2398.9299999999998,8703.2100000000009,3203.7399999999998,6251.2600000000002,1005.48,1788.8,7777.8400000000001,3103.2600000000002,2854.98,1168,1525.5800000000002,5301.0299999999997,3537.5999999999999,3196.5100000000002,7395.1899999999996,12723.18,3608.54,12992.33,2459.0900000000001,2276.4900000000002,4106.4899999999998,16947.98,3145.8600000000001,2190.9700000000003,4615.7200000000003,5199.5500000000002,1643.1700000000001,7307.1800000000003,5145.5200000000004,3401.1999999999998,1381.1900000000001,4114.6199999999999,1723.45,8183.5600000000004,1932.6400000000001,2310.8299999999999,1405.8299999999999,10974.23,4143.0500000000002,2136.02,2782.02,4352.46,2265.1999999999998,11441.92,3458.3499999999999,1212.1300000000001,4501.6300000000001,3173.9000000000001,1563.54,4331.4099999999999,2400.0500000000002,1938,5177.4499999999998,4266.5500000000002,1387.95,8560.5499999999993,1588.5699999999999,4331.7110000000002,3628.8699999999999,14979.26,32451.599999999999,3640.96,2464.27,4660.75,14674.960000000001,1957.98,40519.919999999998,2609.1600000000003,17832.77,2521.52,1528,2095.4099999999999,5251.3100000000004,6878.8800000000001,979.62,1572.47,1359.4100000000001,4207.4300000000003,3813.0800000000004,1899.0799999999999,5415.1999999999998,2010.1699999999998,4242.1000000000004,2167.4499999999998,2622.77,5954.29,2483.8000000000002,5921.6499999999996,5218.3699999999999,2878.46,1820.8299999999999,4905.3500000000004,1316.5599999999999,2517.75,20315.84,1025.1800000000001,13679.610000000001,41184.300000000003,2019.73,1757.9100000000001,2010.53,1653.28,1362.02,1743.5999999999999,2617.3299999999999,2442.4699999999998,4762.0699999999997,2476.25,4298.3000000000002,8359.0300000000007,1920.8299999999999,6450.8800000000001,8403.2199999999993,2485.8899999999999,3005.9500000000003,2342.5700000000002,3096.1399999999999,7256.2399999999998,1992.98,6848.8699999999999,4983.9499999999998,5019.1700000000001,2508.4700000000003,10507.5,4562.8299999999999,2065.2600000000002,2776.1900000000001,17403.209999999999,1355.29,1370.6500000000001,1771.0900000000001,1429.03,1721.4400000000001,3871.1900000000001,2286.8899999999999,6739.0100000000002,4195.5,2408.96,2806,3003.2600000000002,1716.03,6887.1199999999999,2621.7600000000002,3176.1300000000001,3323.75,1766.78,2515.4499999999998,2050.9499999999998,2855.5099999999998,2750.8299999999999,3680.1599999999999,28967.07,3001.9099999999999,2543.1900000000001,4704.54,2232.5999999999999,2235.1300000000001,1825.5599999999999,3729.5900000000001,2212.8899999999999,2182.4099999999999,1851.9000000000001,1436.05,11555.190000000001,2343.1999999999998,4819.3199999999997,9027.5499999999993,7136.1599999999999,10924.190000000001,4698.79,5535.0200000000004,3695.9099999999999,2827.0500000000002,3694.23,1339.8900000000001,2359.1599999999999,1596.71,749.81000000000006,10776.42,1110.2,8207.3700000000008,690.83000000000004,3934.25,80489.210000000006,2008.0899999999999,4091.1599999999999,4518.4300000000003,29480.061000000002,6057.5900000000001,3866.0500000000002,7637.5600000000004,3127.8499999999999,3023.7800000000002,2182.8800000000001,4258.2699999999995,1101.0899999999999,3970,2387.71,11368.74,2121.4299999999998,65500.07,1361.23,22638.52,8158.5100000000002,2316.9099999999999,2077.5100000000002,5990.6099999999997,1200.1500000000001,5716.1400000000003,9374.8600000000006,4292.5900000000001,7493.7700000000004,2119.8600000000001,1247.1200000000001,1378.0999999999999,1931.72,726.25,2144.4699999999998,2529.46,6130.75,1265.6299999999999,2618.02,4306.8000000000002,4202.6599999999999,2605.8099999999999,3996.7999999999997,1778.97,6273.4499999999998,5459.04,3015.5500000000002,3862.1900000000001,2651.23,5416.3499999999995,2739.5900000000001,11013.82,4287.5,2507.4900000000002,4608.9399999999996,3084.5799999999999,6324.7600000000002,3983.3400000000001,2737.0500000000002,4036.77,8915.9899999999998,5110.46,1375.6500000000001,4832.8999999999996,6691.1300000000001,2740.9200000000001,3940.1300000000001,1729.4300000000001,2401.0700000000002,2231.96,1082.71,1271.1499999999999,6286.54,4022.7199999999998,1354.8199999999999,4038.4499999999998,2744.1399999999999,12213.01,1285.97,1504.26,3047.8499999999999,1899.1200000000001,3999.8900000000003,2376.5100000000002,3358.3400000000001,1695.1500000000001,1311.6400000000001,5498.6400000000003,10051.530000000001,2646.4400000000001,7589.2399999999998,3423.4200000000001,3034.8800000000001,14218.49,19726.759999999998,25391,1476.3,2462.3299999999999,15856.299999999999,2704.6300000000001,7021.6599999999999,3159.46,10405.030000000001,2273.9499999999998,14562.91,2371.7399999999998,14556.969999999999,2430.29,52422.299999999996,4247.1099999999997,1605.8400000000001,3180.2800000000002,1679.8,2422.2000000000003,6568.0900000000001,4191.9200000000001,84541.169999999998,3265.4500000000003,2970.1399999999999,2154.8800000000001,5434.1300000000001,7712.71,11645.700000000001,4168.46,2092.7400000000002,4387.7600000000002,3346.4099999999999,3101.6599999999999,2547.2800000000002,3132.96,3141.4000000000001,3372.9200000000001,2604.46,17885.32,1378.1600000000001,20329.68,1982.45,2751.6399999999999,2690.1500000000001,2234.8600000000001,5393.8800000000001,4145.3299999999999,10245.49,10300.98,1572.97,2475.3200000000002,2166.4200000000001,4134.9099999999999,2304.5100000000002,4939.2399999999998,2805.27,3817.1599999999999,3105.0999999999999,3285.96,3768.0799999999999,5925.4800000000005,1772.0699999999999,2907.6500000000001,3943.6000000000004,29892.5,2749.6999999999998,51208.870000000003,7641.9899999999998,3026.8899999999999,2585.1999999999998,15848.07,4656.7200000000003,2355.4400000000001,1094.3900000000001,1333.5699999999999,2018.4000000000001,1583.28,3068.04,20312.360000000001,2239.0999999999999,2534.7400000000002,3028.9299999999998,26286.75,60102.599999999999,950.61000000000001,1633.3299999999999,1699.0999999999999,4618.4099999999999,2141.7400000000002,2540.02,1160.8399999999999,17670.939999999999,1158.02,4568.9899999999998,1417.01,4411.3800000000001,4369.5600000000004,3681.0300000000002,3473.8000000000002,2503.8899999999999,975.63,3171.54,1705.55,10705.799999999999,7111.1800000000003,349164.34999999998,1840.99,2169.25,2756.2400000000002,2600.3299999999999,1897.6900000000001,9918.1599999999999,4512.9300000000003,1493.1200000000001,7516.3100000000004,7545.1400000000003,6650.8299999999999,3526.8099999999999,4797.6999999999998,3757.9200000000001,21964.139999999999,1979.6000000000001,7318.9099999999999],"mode":"markers","type":"scatter3d","name":"2","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"frame":null},{"x":[74,44,203,98,269,264,260,260,198,51,227,310,50,157,318,138,45,38,99,292,51,84,298,17,318,368,56,74,71,241,92,318,59,325,45,165,67,366,39,276,256,196,220,53,220,277,112,130,164,322,263,44,120,84,136,84,318,44,280,318,93,212,140,40,318,40,24,196,156,184,275,70,162,59,72,260,53,242,231,37,189,191,7,56,273,226,53,269,247,226,19,157,8,169,261,176,80,91,86,121,200,171,303,93,234,165,171,245,49,148,46,170,264,165,106,136,101,19,201,170,94,247,157,186,99,205,78,318,311,81,113,19,94,329,255,144,110,317,75,19,23,32,211,99,49,58,64,212,187,36,207,228,30,372,360,194,292,72,366,158,274,320,120,15,73,238,49,201,137,365,234,25,361,361,52,67,215,308,8,198,65,164,106,367,65,67,320,92,214,257,187,116,186,248,93,53,61,127,362,53,365,30,134,73,72,49,187,354,177,366,304,108,159,267,88,95,127,220,67,120,261,24,136,246,205,49,50,26,178,198,36,218,66,254,243,260,180,294,57,50,245,367,87,38,291,254,211,213,29,308,66,47,68,96,38,12,72,78,45,75,42,203,236,236,239,359,74,282,162,36,66,123,232,28,87,325,68,37,182,39,67,80,68,179,53,239,313,84,100,218,23,256,275,372,64,85,113,150,207,183,67,303,262,108,38,277,324,260,289,99,79,88,263,141,290,366,37,278,143,312,85,53,78,374,270,38,270,44,107,23,302,310,65,148,47,47,45,42,50,315,134,166,177,121,270,294,38,176,229,268,204,180,164,332,232,124,312,72,247,68,17,123,135,36,239,56,43,30,366,68,175,129,93,271,80,32,213,232,186,82,81,51,262,59,246,101,93,31,273,32,163,182,49,163,73,310,289,131,362,226,151,43,228,141,24,58,282,182,135,163,65,257,57,217,58,40,212,155,122,52,35,355,246,165,65,25,106,281,113,261,47,36,368,45,327,59,59,142,30,73,170,213,289,71,71,32,59,218,47,51,16,155,368,148,68,98,201,116,207,281,112,122,26,106,191,211,361,127,26,213,98,150,320,302,259,31,318,28,148,98,75,358,117,373,367,137,64,369,80,187,284,369,331,122,50,309,119,98,141,56,366,241,277,46,47,109,302,30,24,32,46,253,33,323,187,50,203,77,86,298,59,332,296,129,68,182,59,64,106,75,45,198,322,45,156,44,289,43,43,185,68,203,66,200,96,60,205,74,259,172,64,68,372,46,214,38,161,278,177,319,257,318,87,136,212,68,200,288,225,22,60,18,39,101,137,189,92,91,22,36,16,68,135,204,369,66,227,325,215,44,372,147,8,37,295,309,170,72,152,319,127,25,115,259,106,310,232,290,26,145,109,71,88,79,61,368,124,8,68,154,180,214,7,89,262,205,29,292,269,31,316,22,21,38,177,120,89,313,253,270,159,225,374,66,81,368,185,151,145,228,215,224,26,253,60,254,71,54,80,369,46,15,113,226,290,182,49,121,197,71,228,115,372,320,96,80,262,110,257,228,164,39,295,25,186,107,232,242,171,143,373,75,257,23,234,217,130,121,217,266,134,43,164,175,72,235,63,40,266,141,190,269,171,157,320,305,254,326,253,158,81,99,232,175,201,246,32,263,57,255,214,299,49,339,368,280,231,175,94,339,17,57,361,371,373,59,208,325,297,248,66,78,199,117,291,64,228,30,89,116,15,313,204,255,177,80,231,4,156,46,115,128,304,365,200,310,98,99,219,166,215,247,368,112,172,155,66,30,192,156,78,68,337,205,37,24,367,103,42,46,303,183,361,70,68,130,59,366,12,254,199,284,245,148,222,257,37,58,71,302,191,113,276,182,197,50,166,235,61,197,124,206,26,136,43,94,301,46,290,366,201,191,313,112,198,337,43,37,47,313,197,85,61,184,239,298,162,84,30,298,260,326,98,128,220,203,219,88,127,212,89,357,204,61,217,99,138,177,276,226,163,310,70,254,233,38,53,96,81,74,211,80,231,285,211,369,176,163,315,66,15,267,359,362,156,16,26,23,242,148,361,45,95,7,242,231,259,275,204,33,99,28,254,255,359,12,313,218,123,211,63,81,284,51,246,74,45,57,93,280,278,19,31,87,365,51,157,297,108,192,361,40,235,109,183,86,56,54,253,295,233,325,260,112,225,192,176,186,36,26,36,189,57,94,255,85,78,302,92,248,54,45,267,67,99,144,372,217,54,178,224,204,373,121,172,21,257,162,162,112,66,68,253,17,219,262,73,135,282,197,68,36,305,117,4,16,179,126,170,37,242,267,8,367,178,283,292,280,64,273,285,60,17,225,187,318,85,299,86,61,234,238,241,17,187,170,50,371,261,23,47,231,196,180,59,71,198,318,19,317,42,67,361,229,53,26,138,261,305,306,260,92,98,334,158,64,362,180,219,299,316,358,53,84,72,65,141,64,37,200,44,371,46,359,124,73,51,254,71,136,357,23,130,112,73,58,148,18,129,59,227,73,284,369,116,361,29,282,113,106,98,318,112,113,372,330,68,172,186,262,213,199,128,43,119,21,66,17,73,71,84,106,253,31,44,289,172,112,264,25,86,227,370,219,128,213,32,18,44,304,358,129,240,156,226,107,220,197,266,166,242,365,106,150,10,67,318,173,213,72,176,256,208,266,71,82,220,304,278,277,177,50,371,37,227,155,182,235,9,33,112,205,302,262,61,229,86,21,24,198,360,262,179,43,43,121,42,45,33,337,51,58,371,85,78,91,156,222,30,365,205,257,315,164,277,169,26,29,54,359,197,254,306,198,266,40,284,165,213,172,31,261,45,66,374,72,51,43,72,45,29,68,315,213,56,89,101,17,322,29,24,200,64,310,166,239,198,254,213,254,53,78,70,37,325,105,15,39,129,192,21,92,112,190,191,365,358,271,287,268,47,78,208,176,59,21,135,124,247,175,245,71,45,369,262,22,158,302,64,15,58,80,106,73,65,187,283,361,212,178,68,5,33,227,19,51,240,186,81,374,232,273,362,360,46,261,198,214,373,22,228,59,169,358,59,299,156,61,138,284,38,156,78,298,87,371,61,127,183,113,80,81,134,214,297,162,141,367,58,205,227,162,197,172,166,291,63,218,56,288,31,285,28,94,100,190,255,52,227,137,217,80,84,232,325,182,117,64,37,117,72,47,145,60,135,105,372,60,31,19,38,201,74,92,14,264,36,108,305,366,75,260,170,284,56,361,305,44,45,309,367,180,42,108,364,332,22,284,312,91,259,31,67,40,10,89,103,21,56,86,144,52,177,86,47,136,184,23,29,21,47,165,291,185,368,17,196,158,31,11,110,264,235,248,268,80,123,50,212,364,277,114,21,137,26,197,56,305,14,61,74,246,163,21,70,56,145,277,185,15,368,29,148,214,222,269,17,178,303,281,214,196,255,264,374,113,226,373,85,194,233,238,114,283,305,105,66,373,297,110,129,239,56,29,112,54,91,59,228,57,280,295,11,232,257,42,84,113,163,182,57,92,289,84,46,72,28,150,297,303,148,186,81,297,103,322,217,28,246,184,304,373,10,42,10,257,359,79,238,47,151,120,22,17,324,275,175,88,157,182,30,276,373,362,11,187,264,136,74,179,163,357,207,268,42,56,59,332,176,291,364,228,158,185,184,29,46,316,31,15,227,25,253,200,28,359,67,35,179,145,219,278,192,177,285,129,29,161,28,254,177,26,305,16,127,33,82,57,229,186,185,78,232,47,225,54,4,333,149,108,39,173,267,140,234,187,109,282,282,295,207,22,15,368,220,259,248,239,311,158,99,358,267,261,239,113,23,211,319,358,189,135,201,18,313,149,232,26,120,187,151,50,245,278,217,92,23,134,70,308,68,245,226,214,40,155,30,213,67,296],"y":[1,1,1,3,1,1,3,2,1,1,1,1,1,1,1,1,1,1,3,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,2,1,1,2,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,1,2,2,1,1,1,1,1,3,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,2,1,2,1,2,2,1,1,2,1,2,1,2,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,2,1,1,3,1,1,1,1,2,1,1,2,1,1,3,1,1,1,1,1,1,3,1,1,1,1,1,2,2,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,2,1,3,2,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,3,2,1,1,1,2,1,1,1,1,1,1,2,1,1,1,3,3,1,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,2,1,1,1,1,1,1,1,2,2,1,3,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,2,1,6,1,1,1,3,2,2,1,1,3,1,1,1,1,2,2,1,2,2,2,1,2,1,1,1,1,1,1,2,1,1,2,1,1,2,1,1,1,1,1,2,2,1,1,1,1,1,1,2,3,1,1,1,1,1,1,1,1,2,2,1,1,1,2,1,1,1,3,1,1,2,1,1,2,1,1,1,1,2,3,1,1,1,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,2,3,1,1,1,1,1,1,2,1,2,1,2,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,1,1,1,1,2,2,1,1,2,1,1,2,1,1,1,2,1,2,2,2,1,1,1,1,1,1,1,1,1,1,2,1,2,2,1,1,1,1,1,1,1,1,1,2,1,1,2,2,1,3,2,2,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,2,1,1,2,1,1,1,2,2,1,1,1,2,1,1,1,1,1,1,1,2,1,2,1,2,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,2,1,2,1,1,1,3,1,2,1,1,1,1,1,1,3,3,1,2,1,1,3,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,2,2,1,1,1,1,3,1,1,1,1,2,1,1,2,2,1,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,1,2,1,2,2,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,3,3,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,2,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,2,1,2,2,2,2,1,1,2,2,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,3,1,1,2,1,1,1,1,1,1,1,3,3,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,4,2,1,3,1,1,2,1,1,1,1,2,1,1,1,3,1,1,1,1,1,1,1,2,1,3,8,3,2,1,1,1,1,2,1,1,3,1,2,2,1,2,1,2,2,2,1,1,1,1,1,4,1,2,1,1,1,2,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,3,1,2,1,1,1,1,1,1,1,2,1,1,1,1,2,2,2,3,1,2,1,1,3,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,1,1,2,2,2,1,1,1,2,1,3,1,1,1,1,1,2,1,1,2,1,2,1,1,1,1,2,1,1,2,1,2,1,1,2,1,1,1,1,1,2,1,2,2,1,2,1,1,1,1,3,1,1,1,1,1,1,1,3,1,1,1,1,4,1,2,2,2,1,1,1,1,1,2,1,1,4,1,1,1,1,1,1,1,1,1,2,1,1,1,2,3,1,1,1,2,1,1,1,1,2,1,1,1,1,1,2,1,1,2,2,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,3,1,1,1,1,2,1,1,1,2,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,2,1,2,2,1,3,1,1,1,2,1,1,2,1,2,1,1,1,3,1,1,2,1,2,1,2,2,2,2,2,1,2,1,1,1,1,1,2,1,1,2,1,1,2,2,1,1,1,1,3,1,1,1,1,4,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,2,1,2,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,2,1,1,1,2,2,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,2,3,1,2,2,1,1,1,1,1,2,1,2,2,2,1,2,1,2,1,2,1,1,1,1,1,1,2,1,1,3,2,1,1,1,2,2,1,1,2,1,1,2,1,1,3,1,2,1,1,1,2,1,1,2,2,1,1,1,1,2,1,1,1,2,1,1,2,1,2,1,2,1,1,1,1,1,1,1,2,1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,2,1,2,1,1,1,2,1,1,2,2,3,1,3,1,1,1,1,1,1,1,1,3,1,2,1,1,1,1,3,1,1,2,2,1,1,2,1,1,1,3,2,1,1,1,2,2,1,1,1,1,1,1,1,2,1,2,2,2,2,1,2,1,1,1,1,1,1,2,2,1,3,2,1,1,1,1,1,1,2,1,3,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,2,1,1,2,1,2,1,1,2,1,1,1,1,1,1,1,2,2,2,2,1,1,2,1,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,1,2,1,1,2,2,2,1,1,2,2,1,1,1,1,2,1,2,1,1,1,1,1,1,1,2,2,1,2,1,1,1,1,3,1,1,2,1,2,1,3,1,1,2,1,2,2,1,1,1,4,2,1,1,1,1,1,1,1,1,1,2,2,1,1,1,2,3,2,2,1,1,1,1,1,1,1,2,3,1,1,2,1,1,1,1,1,1,3,1,2,1,1,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,2,1,1,2,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1],"z":[221.16,317.75999999999999,488.21000000000004,276.35000000000002,500.24000000000001,917.69999999999993,534.62,603.05000000000007,1407.7,143.94,234.75000000000003,931.42999999999995,205.25,555.66000000000008,63.240000000000002,240.38,346.89999999999998,185.34999999999999,350,202.56,235.56,964.21000000000004,690.48000000000002,297.29000000000002,1158.1800000000001,365.31,301.58000000000004,678.60000000000002,512.67999999999995,398.36000000000001,296.64999999999998,56.729999999999997,132.80000000000001,211.94999999999999,396.25999999999999,708.10000000000002,917.27999999999997,285.29999999999995,380,277.39999999999998,54.090000000000003,357.72000000000003,896,261,455.25,580.08000000000004,349.69999999999999,386.80000000000001,316.48000000000002,1645.98,1223.8900000000001,612.94000000000005,481.88,840.25,147.78,384.5,129.22999999999999,221.23999999999998,52,77.519999999999996,568.81999999999994,583.19999999999993,281.01999999999998,86.200000000000003,21,415.79000000000002,381.80000000000001,140.13999999999999,714.88,360,169.80000000000001,97.050000000000011,1950.98,243.34999999999999,162,185.40000000000001,214.59999999999999,2622.4810000000002,181.15000000000001,565.5,874.5,359.10000000000002,71.140000000000001,116.59999999999999,110.95,285.75,566.11000000000001,632.98000000000002,1213.05,227.93000000000001,197.84,703.25,137.34999999999999,236.07000000000002,1201.52,254.55000000000001,268.26999999999998,317.80000000000001,168.69000000000003,226.29999999999998,124.25,83.700000000000003,27.5,519.45000000000005,322.39999999999998,1034.3299999999999,648.45000000000005,668.5,380.51999999999998,148.5,251.93000000000001,370.46999999999997,351,219.34999999999999,500.25,871.82000000000005,327.01999999999998,250.34999999999999,979.02999999999997,534.99000000000001,540.51999999999998,128.07999999999998,518.63,92.300000000000011,236.06,554.31000000000006,322.63999999999999,15.58,208,330,148.94999999999999,177.91999999999999,575.10000000000002,55.469999999999999,68.25,152.44999999999999,593.23000000000002,337.67000000000002,363.38,222.40000000000001,336.80000000000001,263.38,157.34999999999999,310.96000000000004,366.39999999999998,340.32999999999998,833.52999999999997,1018.42,1680.47,223.97999999999999,323.86000000000001,35.280000000000001,197.31,181.65000000000001,377.49000000000001,496.5,437.16000000000003,324.44999999999999,252.48000000000002,498.96000000000004,162.44999999999999,413.81999999999999,150.94999999999999,211.99000000000001,132.24000000000001,122.45,385.55000000000001,264.14999999999998,478.38999999999999,517.70000000000005,490.07999999999998,261.06,93.350000000000009,497.65000000000003,293.18000000000001,485.98000000000002,175.25,234,50.550000000000004,618.96000000000004,50.299999999999997,651.13,555.87,323.38999999999999,30,442.31999999999999,307.10000000000002,319.94,155.80000000000001,127.64999999999999,209.47999999999999,188.40000000000001,561.25,129.22,135.40000000000001,199.08000000000001,91.679999999999993,122.39999999999999,313.63999999999999,236.11000000000001,1976,419.70000000000005,594.21000000000004,465.70000000000005,72,526.96000000000004,347.49000000000001,321.88,20.600000000000001,234.38,134.90000000000001,506.75,158.56999999999999,263.5,233.25,90.650000000000006,275.44999999999999,405.10000000000002,24.399999999999999,449.96999999999997,1322.8700000000001,307.12,366.13,17.649999999999999,372.19999999999999,429.68000000000001,466.98000000000002,333.81999999999999,556.12,127.2,69.599999999999994,831.45000000000005,229.75,572.31000000000006,86.100000000000009,130.99000000000001,570.65999999999997,164.69,412.07999999999998,172.38,373.01000000000005,966.66000000000008,285.60000000000002,81.599999999999994,132.5,76.230000000000004,516.79999999999995,88.5,204.25,356.94999999999999,305.89999999999998,115.58,558.72000000000003,256.04000000000002,252.68000000000001,51.410000000000004,149.75,722.56000000000006,360.85000000000002,350.85000000000002,181.05000000000001,279.69999999999999,655.47000000000003,734.90999999999997,781.59000000000003,307.94999999999999,208.63,815.78999999999996,95.450000000000003,61.719999999999999,53.649999999999999,258.33999999999997,284.86000000000001,249.58000000000001,124.75,310.25999999999999,281.75999999999999,262.39999999999998,1575.26,603.75,510.19999999999999,1013.58,62.399999999999999,305.28000000000003,189.44,508.55000000000001,91.140000000000001,213,275.39999999999998,310.82999999999998,154.5,487.34999999999997,429.44,228.30000000000001,217.03,572.76999999999998,423.93000000000001,281.50999999999999,439.10000000000002,46.5,424.25999999999999,419.87,241.90000000000001,139.80000000000001,424.70999999999998,219.87,148.22,1160.4099999999999,82.400000000000006,592.24000000000001,434.19999999999999,550.41999999999996,151.44999999999999,271.47000000000003,154.25,327.38,299.52999999999997,176.07999999999998,135,282.75999999999999,374.70000000000005,295.85000000000002,220.46000000000001,1182,402.97999999999996,89.5,1439.6099999999999,175.53,226.58000000000001,87.599999999999994,152.39999999999998,517.79999999999995,200.81999999999999,990,174.58000000000001,421.25,147.66,107.75,162.53,664.00099999999998,250.05000000000001,684.53999999999996,131.53,136.34999999999999,298.89999999999998,717.62,400.30000000000001,236.19999999999999,167.34999999999999,818.28999999999996,288.10000000000002,231.69,112.34,658.95000000000005,301.25999999999999,607.42999999999995,310.14000000000004,312.93000000000001,405,159.91999999999999,132.65000000000001,152.19999999999999,699.20000000000005,314.58999999999997,325.24000000000001,43.25,195,194.94999999999999,233.53,240.68000000000001,243.90000000000001,281.25999999999999,258.60000000000002,375.5,349.5,212.78,266.59999999999997,465.53000000000003,455.56999999999999,161,135.18000000000001,326.06,300.38,329.04000000000002,537.58000000000004,161.34999999999999,318.29000000000002,217.39999999999998,213.00999999999999,440.93000000000001,75.299999999999997,477.31999999999999,176.69,404.45000000000005,164.44999999999999,195.55000000000001,352.82100000000003,190.34999999999999,875.97000000000003,1049.6600000000001,161.13,375.81,650.99000000000001,3.75,239.45999999999998,188.40000000000001,96,126.03,289.69999999999999,678.20000000000005,61.280000000000001,255.59,102,156.85000000000002,561.49000000000001,316.56,324.19,260.69999999999999,139.95000000000002,651.39999999999998,442.73000000000002,310.72000000000003,187.35000000000002,314.69999999999999,273.25999999999999,346.73000000000002,332.44,395.5,634.67999999999995,388.55000000000001,530.47000000000003,165.45000000000002,312.65000000000003,42,136.80000000000001,286.60000000000002,124.95,42.219999999999999,70.800000000000011,359.26999999999998,320,246.53999999999999,200.43000000000001,193.25,390.86000000000001,85.599999999999994,123.66,264.13,519.81000000000006,331.13999999999999,142.69999999999999,382.31,209.41,79.480000000000004,509.04000000000002,404.30000000000001,445.14999999999998,457.81999999999999,229.75,367.15000000000003,606.21000000000004,352.15000000000003,318.04000000000002,713.11000000000001,109.44,115.08000000000001,431.98000000000002,304.25,255.44999999999999,795.32000000000005,469.19,230.06,326.55000000000001,390.85000000000002,219.40000000000001,115.66,243.63,231.11000000000001,150.5,39.950000000000003,335.22000000000003,2.9500000000000002,422.86000000000001,214.79999999999998,447.05000000000001,622.67000000000007,458.44999999999999,436.18000000000001,466.33000000000004,286.70999999999998,187.87,305.5,332.69999999999999,30.599999999999998,309.09000000000003,679.45000000000005,233.40000000000001,148.71000000000001,256.85000000000002,370.44999999999999,135,402.71999999999997,135.16,310.55000000000001,286.29000000000002,123.5,79.900000000000006,132.90000000000001,293.74000000000001,356.80000000000001,390.05000000000001,379.19999999999999,339.33999999999997,157.80000000000001,415.31,310.74000000000001,882.60000000000002,770.34000000000003,309.91000000000003,287.38,357.14999999999998,120,366.41999999999996,363.40000000000003,601.02999999999997,1000.63,322.93000000000001,40.560000000000002,354.85000000000002,295.73000000000002,106.81,482.85000000000002,256.60000000000002,205.83000000000001,191.86000000000001,245.15000000000001,704.39999999999998,375.33999999999997,277.94,1147.02,492.10000000000002,206.19,109.80000000000001,716.69000000000005,158.02000000000001,494.85000000000002,245.48000000000002,445.05000000000001,200.63,339.88,310.75,249.88,82.599999999999994,285.89999999999998,214.71000000000001,227.47000000000003,136,469.13,108,215.46000000000001,131.25,48.960000000000001,428.65999999999997,58.5,135.59999999999999,266.39999999999998,93.799999999999997,285.60000000000002,404.69999999999999,195,656.15999999999997,202.84999999999999,516.27999999999997,289.60000000000002,90.420000000000002,182.64000000000001,132.03999999999999,221.65000000000001,201.72999999999999,548.5,237.41999999999999,265.99000000000001,256.94999999999999,111,204.24000000000001,250.84999999999999,400.94999999999999,291.38,730.41999999999996,225.30000000000001,120,175.5,127.2,261.89999999999998,51,221.69,110.95,332.42000000000002,163.91999999999999,206.09,199.45000000000002,262.39999999999998,376.33999999999997,285.83999999999997,957.98000000000002,349.25,835.34000000000003,655.5,75.599999999999994,679.43999999999994,760.10000000000002,919.69999999999993,371.58999999999997,395.69,161.65000000000001,143.70000000000002,460.70999999999998,35.400000000000006,105.56,14.850000000000001,295.19999999999999,135.38999999999999,39.75,423.85000000000002,229.47,162.06999999999999,471.84000000000003,205.35999999999999,143.85999999999999,24.350000000000001,76.320000000000007,295.13,121.7,190.47,896.80000000000007,338.64999999999998,215.22,106.67999999999999,986.08000000000004,279.80000000000001,276.75,62.5,246.85999999999999,490.60000000000002,111.63,190.47,1127.45,347.59000000000003,173.66,184.91,403.38999999999999,146.56,232.27000000000001,244.31,266.66000000000003,390.69,139.19999999999999,411,235.77000000000001,81.299999999999997,226.41999999999999,115.77,325.44999999999999,345.25,124.75,199.34999999999999,190.58000000000001,401.07999999999998,507.44999999999999,579.85000000000002,50.479999999999997,310.14999999999998,112.03,126.45,306.36000000000001,192.02000000000001,117.05,382.81,594.62,140.55000000000001,241.44999999999999,307.56,307.30000000000001,159.94,90.959999999999994,110.65000000000001,476.88,303.63,396.91000000000003,300.31,180.44999999999999,110.03999999999999,686.75999999999999,170.5,185.80000000000001,160.46000000000001,198.09,157.70000000000002,385.19999999999999,322.69,94.799999999999997,485.86000000000001,297,299.86000000000001,211.79999999999998,150,437.39999999999998,310.56,318.06,180.75,351.89999999999998,334.44999999999999,116.18000000000001,256.69999999999999,185.06,120.59999999999999,691.60000000000002,202.35000000000002,571.75999999999999,13.919999999999998,68.439999999999998,104.10000000000001,1123.75,359.35000000000002,629.39999999999998,620.96000000000004,308.19999999999999,223.91000000000003,612.81000000000006,1065.1199999999999,182.09999999999999,107.62,179.40000000000001,167.27000000000001,163.77000000000001,274.80000000000001,458.25999999999999,240.21000000000004,357.39999999999998,906.23000000000002,30.300000000000004,192.44999999999999,31.929999999999996,439.45999999999998,150.68000000000001,270.80000000000001,237.78,183.20000000000002,342.39999999999998,305.42000000000002,314.67000000000002,210.5,36.130000000000003,442.28999999999996,230.40000000000001,340.86000000000001,129.47999999999999,230.85999999999999,323.05000000000001,360,203.42000000000002,281.05000000000001,636.08000000000004,365.10000000000002,7.4900000000000002,113.67,179.52000000000001,98.700000000000003,133.44999999999999,168.72999999999999,187.51999999999998,566.88999999999999,93.350000000000009,347.54000000000002,218.53,565.89999999999998,318.64999999999998,83,660.26999999999998,554.66999999999996,498.15000000000003,209.40000000000001,191.74000000000001,266.63,449.49000000000001,304.97000000000003,312.68000000000001,80.280000000000001,166.63,823.39999999999998,889.43999999999994,304.18000000000001,518.13999999999999,718.03999999999996,204.62,119.92,312.89999999999998,167.16,81.150000000000006,345.71000000000004,988.04000000000008,639.92999999999995,310.43000000000001,834.43999999999994,316.25,549.04999999999995,100.40000000000001,178.98000000000002,106.47999999999999,389.49000000000001,426.24000000000001,379.69999999999999,662.20000000000005,549.27999999999997,160.5,250.25999999999999,59.400000000000006,302.04000000000002,610.60000000000002,280.50999999999999,266.25,620.05999999999995,60,787.99000000000001,71.950000000000003,368.75,454.66000000000003,228.96000000000001,220.44,496.15999999999997,293.09999999999997,348.58999999999997,148.33000000000001,24.75,94.920000000000002,653.31000000000006,247.5,233.34999999999999,217.23999999999998,308,650.15999999999997,93.600000000000009,129.75,711.17999999999995,434.60000000000002,140.22000000000003,107.23999999999999,240.5,373.01999999999998,283.43000000000001,105.5,382.19999999999999,343.69999999999999,114.95,284.39999999999998,181.34999999999999,270.15000000000003,613.08000000000004,275.80000000000001,59.400000000000006,139.31999999999999,60.960000000000001,246.5,468.64999999999998,289.87,659.48000000000002,508.20000000000005,216.95000000000002,170.88,310.74000000000001,465.16000000000003,131.25,1234.8800000000001,452.31999999999999,223.38999999999999,214.44,153.24000000000001,149.56999999999999,193.29000000000002,171,337.71000000000004,294.17000000000002,233.21000000000001,128.59,38.25,208.79999999999998,202.83000000000001,429.69999999999999,502.44999999999999,335.69999999999999,63.420000000000002,274.80000000000001,163.09999999999999,368.39999999999998,583.55999999999995,147.40000000000001,1061.6900000000001,102,231.31999999999999,217.59999999999999,246.5,146.14000000000001,161.59999999999999,120.06,371.01999999999998,166.50999999999999,210.58000000000001,171.81,151.40000000000001,311.37,162.25,259.08999999999997,114.98,135.33000000000001,1079.1000000000001,158.09,162.40000000000001,214.13,1109.4000000000001,153.52000000000001,70.740000000000009,227.87,599.73000000000002,30.100000000000001,139.09999999999999,107.86,579.60000000000002,217.90000000000001,357.60000000000002,238.80000000000001,307.33999999999997,488.31999999999999,40,692.29999999999995,433.71999999999997,317.11000000000001,389.18000000000001,391.72000000000003,566.89999999999998,295.05000000000001,596.66999999999996,311.10000000000002,100.34999999999999,639.75999999999999,105.78000000000002,169,553.88,283.73000000000002,632.93999999999994,152.15000000000001,45.300000000000004,218.34999999999999,318.24000000000001,330.79000000000002,173.94999999999999,55.979999999999997,90,190.56999999999999,266.93000000000001,37.5,721.06000000000006,246.75,46.200000000000003,140.38999999999999,194.59999999999999,420.25,293.79000000000002,143.19,92.599999999999994,321.91000000000003,107.55000000000001,125.3,327.68000000000001,208.62,156.87,465.45000000000005,143.04999999999998,370.63,516,321.44999999999999,280.88,138.84,45.600000000000001,307.94999999999999,124.08000000000001,221.83000000000001,777,613.68000000000006,540.14999999999998,144.14999999999998,340.5,943.97000000000003,80.400000000000006,385.03000000000003,714.50999999999999,107.01000000000001,139.94,109.72999999999999,96.549999999999997,340.48000000000002,273.48000000000002,438.45999999999998,289.86000000000001,244.44000000000003,94.530000000000001,174.02000000000001,33.100000000000001,313.92000000000002,111.72,330.76999999999998,249.70000000000002,260.85000000000002,128.19999999999999,305.28000000000003,56.25,145.00999999999999,114.69,764.57000000000005,6.3000000000000007,429.20999999999998,437.53000000000003,248.65000000000001,127.08,102.82000000000001,134.44,123.39,293.52999999999997,594,239.90000000000001,405,271.29000000000002,553.85000000000002,304.94999999999999,190.75,617.60000000000002,579.49000000000001,295.82999999999998,272.96000000000004,426.53000000000003,460.94999999999999,703.22000000000003,329.21999999999997,324.50999999999999,186.30000000000001,612.06000000000006,150.54999999999998,696.19000000000005,20.399999999999999,169.21000000000001,245.77000000000001,232.96000000000001,82.200000000000003,217.72999999999999,654.32000000000005,456.39999999999998,340.83999999999997,235.78,107.14,162.80000000000001,188.44,62.700000000000003,89.650000000000006,111,122.93000000000001,457.69999999999999,265.25,736.93000000000006,2300.4000000000001,283.79000000000002,106.75,205.91,447.05000000000001,582.63999999999999,327.60000000000002,481.79000000000002,562.48000000000002,145.06,664.19999999999993,301.89999999999998,237.41999999999999,422.69999999999999,475.74000000000001,335.54000000000002,212.25,310.30000000000001,141.70000000000002,79.900000000000006,435.82999999999998,414.69999999999999,115.31,105.80000000000001,351.30000000000001,315.98000000000002,323.25,93.299999999999997,629.36000000000001,248.65000000000001,603.37,975.5,40.799999999999997,498.5,321.24000000000001,713,333.18000000000001,136.65000000000001,63.659999999999997,128.31,295.08999999999997,876.93999999999994,351.00999999999999,186.66,717.57000000000005,336.04000000000002,188.69,551.46000000000004,238.05000000000001,205.79999999999998,176.90000000000001,328.94999999999999,129.84999999999999,136.31,117.72,126.05000000000001,193.65000000000001,107.33,381.66000000000003,171.15000000000001,176.34,850.86000000000001,230.90000000000001,146.16,310.82999999999998,277.48000000000002,316.58999999999997,623.33000000000004,224.50999999999999,328.76999999999998,209.49000000000001,212.16999999999999,142.78,157.20000000000002,104,632.27999999999997,258.69999999999999,353.10000000000002,186.05000000000001,467.5,137.80000000000001,127.88,233.25,389.61000000000001,231.93000000000001,130.31999999999999,509.08999999999997,35.700000000000003,515.19000000000005,75,309.5,200.25999999999999,329.33999999999997,310.70000000000005,216.30000000000001,282.68000000000001,162.24000000000001,516.13,178.98000000000002,1193.8099999999999,746.18000000000006,332.17000000000002,251.71000000000001,24.050000000000001,71.790000000000006,712.62,178.48000000000002,154.72,350.35000000000002,453.38,134.36000000000001,209.40000000000001,205.41000000000003,385.56,266.5,152.75999999999999,248.80000000000001,433.36000000000001,308.13999999999999,426.85000000000002,48.349999999999994,635.89999999999998,23.350000000000001,399.62,226.70000000000002,424.02999999999997,137.69999999999999,292.20999999999998,376.70000000000005,111.70999999999999,30.149999999999999,95.290000000000006,185.20000000000002,223.85999999999999,87.799999999999997,380,156.59999999999999,295.05000000000001,341.58999999999997,153.12,172.80000000000001,235.25,432.44999999999999,60.479999999999997,291.5,225.40000000000001,130.05000000000001,106.80000000000001,406.39999999999998,473,490.47000000000003,179.40000000000001,323.40000000000003,389.12,435.60000000000002,160.38999999999999,678.79999999999995,327.83999999999997,382.13999999999999,306.57999999999998,136.19999999999999,163.80000000000001,165,109.2,106.96000000000001,188.83000000000001,637.75,151.5,320.25,157.63,127.45,178.83000000000001,98.300000000000011,193.15000000000001,695.65999999999997,368.26999999999998,323.80000000000001,1248.48,147.34999999999999,174.05000000000001,259.68000000000001,417.59999999999997,463.43000000000001,236.81,173.06,163.65000000000001,228,352.85000000000002,249.65000000000001,231.56999999999999,180.35999999999999,391.94999999999999,533.77999999999997,51.839999999999996,495.98000000000002,582.61000000000001,636.64999999999998,532.5,410.97000000000003,182.59,113.34999999999999,181.38999999999999,225.60000000000002,316.10000000000002,91.799999999999997,218.46000000000001,485.5,570.75999999999999,139.84999999999999,614.34000000000003,253.88,628.09000000000003,421.45000000000005,323.09000000000003,352.80000000000001,409.25,130.94999999999999,76.740000000000009,450.15999999999997,217.74000000000001,136.00999999999999,321.77999999999997,644.08000000000004,239.23000000000002,134,285.41000000000003,236.56,103.95,204.25999999999999,252.59,255.25,310.46999999999997,1466.3099999999999,355.44999999999999,276.88,611.08000000000004,125.65000000000001,278.76999999999998,288.49000000000001,202.09999999999999,449,33,482.75999999999999,101.36,809.44000000000005,251.03999999999999,207.84999999999999,71.400000000000006,127,365.5,424.55000000000001,394.37,256.55000000000001,165,107,742.36000000000001,230.17000000000002,81.359999999999999,242.06,400.80000000000001,384.16000000000003,552.39999999999998,935.62,189,54.149999999999999,302.65000000000003,180.06,176.90000000000001,630.76999999999998,1954.99,13.52,239.55000000000001,128.59999999999999,294.74000000000001,194.69999999999999,228.34,454.54000000000002,133.18000000000001,282.05000000000001,203.05000000000001,306,221.53,128.44999999999999,235.88,100.2,582.16999999999996,424.30000000000001,474.02999999999997,174.94999999999999,347.39999999999998,227.97,205.16999999999999,389.77999999999997,314.74000000000001,31.850000000000001,212.09999999999999,231.68000000000001,143.10000000000002,231.90000000000003,327,591.87,713.02999999999997,560.71000000000004,856.00999999999999,406.68000000000001,400.19999999999999,320.94999999999999,159.68000000000001,596.18999999999994,119.5,436.70999999999998,321.30000000000001,198.41000000000003,229.46000000000001,263.75999999999999,573.23000000000002,77.829999999999998,549.88,562.98000000000002,352.89999999999998,145.12,160.65000000000001,303.21999999999997,115.34999999999999,611.60000000000002,253.37,567.55999999999995,186.15000000000001,65.049999999999997,104.5,144.90000000000001,643.38999999999999,100.86,131.15000000000001,506.63,369.98000000000002,130.59999999999999,200.18000000000001,38.920000000000002,227.51000000000002,68.030000000000001,198.28999999999999,258.93000000000001,192.72999999999999,120.95,230.44,279.58999999999997,207.09,604.39999999999998,210.39000000000001,141.12,465.39999999999998,114.52,508.38999999999999,25.199999999999999,118.86,636.25,188.46000000000001,428.33999999999997,241.56,271.75,467.78999999999996,338.13,346.97000000000003,132.80000000000001,111.5,2135.46,124.45,164.28,29.100000000000001,321.94999999999999,152.34999999999999,104.7,481.31999999999999,59.900000000000006,328.13,81.120000000000005,307.54000000000002,36.25,285.11000000000001,156.59999999999999,392.44,979.19999999999993,238.66,231.34,260.44999999999999,250.44,10.949999999999999,110.69999999999999,171.15000000000001,126.35000000000001,149.30000000000001,168.65000000000001,97.5,536.76999999999998,114.84999999999999,118.95,552.89999999999998,283.44000000000005,164.18000000000001,206.60000000000002,420.54000000000002,266.80000000000001,331.35000000000002,373.17000000000002,325.74000000000001,137.16,293.35000000000002,213.08000000000001,661.5,710.98000000000002,102.59999999999999,57.799999999999997,321.65000000000003,224.81,1047,1144.3,389.25999999999999,390.20999999999998,778.19000000000005,177.69,209.56999999999999,160.55000000000001,336.5,747.85000000000002,100.91000000000001,54.699999999999996,309.16000000000003,718.50999999999999,206.08000000000001,334.18000000000001,189.47,329.42000000000002,394.13999999999999,1240.25,970.12,65.340000000000003,34.799999999999997,288.32999999999998,124.45999999999999,170.94999999999999,120.05,142.77000000000001,34,259.17000000000002,167.62,392.38,131.83000000000001,382.79000000000002,100,205.24000000000001,171.69999999999999,348.75,304.38,135.94999999999999,167.40000000000001,181.66,148.30000000000001,52.049999999999997,160.75,87.300000000000011,305.11000000000001,395.32999999999998,1130.21,254,296.36000000000001,842.39999999999998,198.59999999999999,710.39999999999998,126,163.47,412.92000000000002,561.59000000000003,563.10000000000002,301.64999999999998,432.68000000000001,304.19999999999999,442,296.10000000000002,260.38,293.5,163.19999999999999,376.92000000000002,299.82999999999998,307.20999999999998,102,438.65000000000003,468.88,101.09999999999999,229.19999999999999,600.34000000000003,358.14999999999998,351.66000000000003,157.86000000000001,129.75,71.150000000000006,158.92000000000002,141.84999999999999,141.59999999999999,202,585.26999999999998,197.70000000000002,352.91000000000003,96.439999999999998,112.86,271.44,171.25,370.05000000000001,147.30000000000001,183.09,184.66,414.72000000000003,262.63999999999999,374.81,130.18000000000001,183.56,334.62,134.59,392.58999999999997,342.36000000000001,185.72,430.69,120.75,129.69,805.30000000000007,234.65000000000001,235.87,167.09999999999999,366,324.07999999999998,147.12,149.69999999999999,216.40000000000001,381.09000000000003,291.75999999999999,132.55000000000001,261.69999999999999,64.489999999999995,242.13,43.869999999999997,396.38999999999999,536.27999999999997,170.40000000000001,289.5,294,128.69999999999999,114.69,344.90000000000003,144.28999999999999,75.409999999999997,360.35000000000002,160.81999999999999,392.60000000000002,465.42000000000002,140.75,61.300000000000004,584.59000000000003,161.94,221.97,239.12,138.18000000000001,171.71000000000001,228.82999999999998,227.19999999999999,254.13,235.19,124.25,220.31999999999999,115.3,165,175.84999999999999,190.47999999999999,227.06,192.05000000000001,433.76999999999998,149.41,116.09999999999999,189.63,229.44,337.66000000000003,271.05000000000001,176.5,190.94999999999999,603.89999999999998,186.60000000000002,314.10000000000002,151.49000000000001,590.77999999999997,470.73000000000002,428.44999999999999,349.39999999999998,360.85000000000002,451.56,105.8,167.13,577.81000000000006,199.13,405.85000000000002,423.26999999999998,76.320000000000007,9.6999999999999993,95.150000000000006,111.53,212.80000000000001,420.04000000000002,222.95999999999998,226.90000000000001,445,145.99000000000001,536.40999999999997,114.10000000000001,426.69,246.22,215.34999999999999,365.81999999999999,184.41,379.16000000000003,728.84000000000003,175.5,589.51999999999998,58.5,176.09999999999999,754.38,291.13,329.57999999999998,724.88999999999999,313.49000000000001,461.16000000000003,321.59999999999997,101.16,230.09999999999999,344.75,447.53000000000003,314.65999999999997,544.47000000000003,360.07999999999998,147.44999999999999,298.30000000000001,323.29000000000002,479.91999999999996,383.32999999999998,295,179.59999999999999,270.92000000000002,515.77999999999997,162.72,317.88,267.89999999999998,199.84999999999999,110.7,603.25,251.09999999999999,269.37,161.40000000000001,680.85000000000002,153,741.85000000000002,240.30000000000001,231.33999999999997,307.55000000000001,120.31999999999999,461.68000000000001,427],"mode":"markers","type":"scatter3d","name":"3","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2D plots</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rfm_data, <span class="fu">aes</span>(<span class="at">x =</span> Recency, <span class="at">y =</span> Monetary, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recency vs Monetary by Cluster"</span>) <span class="sc">+</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rfm_data, <span class="fu">aes</span>(<span class="at">x =</span> Frequency, <span class="at">y =</span> Monetary, <span class="at">color =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency vs Monetary by Cluster"</span>) <span class="sc">+</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Online-EDA_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="top-revenue-generating-customers" class="level1">
<h1>Top revenue generating customers</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find top revenue-generating customers</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>top_customers <span class="ot">&lt;-</span> rfm_data <span class="sc">|&gt;</span> </span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Monetary)) <span class="sc">|&gt;</span> </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">|&gt;</span>   <span class="co"># Top 20 </span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Customer ID</span><span class="st">`</span>, Recency, Frequency, Monetary, Cluster)</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_customers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 5
   `Customer ID` Recency Frequency Monetary Cluster
           &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;    &lt;dbl&gt; &lt;fct&gt;  
 1         18102       1        89  349164. 2      
 2         14646      10        73  247614. 2      
 3         14156       7       102  196567. 2      
 4         14911       1       205  152148. 2      
 5         13694       9        94  131443. 2      
 6         17511       3        31   84541. 2      
 7         15061       3        86   83284. 2      
 8         16684      15        27   80489. 2      
 9         16754       8        29   65500. 2      
10         17949       7        74   60103. 2      
11         13089       4       109   57912. 2      
12         15311       1       121   56003. 2      
13         17450       3         7   52422. 2      
14         17850       8       155   51209. 2      
15         12931      16        42   50291. 2      
16         13093       9        48   47111. 2      
17         16029       8        47   41184. 2      
18         15838       3        16   40520. 2      
19         14298      11        38   39667. 2      
20         13798       8        54   38683. 2      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate what % of revenue they represent</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>top_10_revenue <span class="ot">&lt;-</span> rfm_data <span class="sc">|&gt;</span> </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Monetary)) <span class="sc">|&gt;</span> </span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Top10_Revenue =</span> <span class="fu">sum</span>(Monetary),</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Revenue =</span> <span class="fu">sum</span>(rfm_data<span class="sc">$</span>Monetary),</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage =</span> <span class="fu">round</span>(Top10_Revenue <span class="sc">/</span> Total_Revenue <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_10_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  Top10_Revenue Total_Revenue Percentage
          &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
1      1450853.      8783262.       16.5</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>